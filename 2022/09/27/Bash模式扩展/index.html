<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="Bash模式扩展" />
    <meta name="hexo-theme-A4" content="v1.9.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Dengpangpang</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--注意：首页既不是post也不是page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--返回顶部css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--目录-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Dengpangpang</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">🍟首页</a></li>
            
        
            
                <li><a href="/list/">📝文章</a></li>
            
        
            
                <li><a href="/tags/">🏷️标签</a></li>
            
        
            
                <li><a href="/categories/">🗂️分类</a></li>
            
        
            
                <li><a href="/about/">👁️关于</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--说明是文章post页面-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            Bash模式扩展
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="post-toc-text">简介</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%97%E7%AC%A6%E6%89%A9%E5%B1%95"><span class="post-toc-text">~字符扩展</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%97%E7%AC%A6%E6%89%A9%E5%B1%95-1"><span class="post-toc-text">? 字符扩展</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%97%E7%AC%A6%E6%89%A9%E5%B1%95-2"><span class="post-toc-text">* 字符扩展</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%97%E7%AC%A6%E6%89%A9%E5%B1%95-3"><span class="post-toc-text">$字符扩展</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%98%E9%87%8F%E6%89%A9%E5%B1%95"><span class="post-toc-text">变量扩展</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AD%90%E5%91%BD%E4%BB%A4%E6%89%A9%E5%B1%95"><span class="post-toc-text">子命令扩展</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%AE%97%E6%9C%AF%E6%89%A9%E5%B1%95"><span class="post-toc-text">算术扩展</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%89%A9%E5%B1%95"><span class="post-toc-text">[]扩展</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#abc-%E6%89%A9%E5%B1%95"><span class="post-toc-text">[abc]扩展</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#start-end-%E6%89%A9%E5%B1%95"><span class="post-toc-text">[start-end]扩展</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%89%A9%E5%B1%95-1"><span class="post-toc-text">{}扩展</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#a-b-c-%E6%89%A9%E5%B1%95"><span class="post-toc-text">{a,b,c}扩展</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#start-end-%E6%89%A9%E5%B1%95-1"><span class="post-toc-text">{start..end}扩展</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%97%E7%AC%A6%E7%B1%BB%E6%89%A9%E5%B1%95"><span class="post-toc-text">字符类扩展</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="post-toc-text">注意事项</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%87%8F%E8%AF%8D%E8%AF%AD%E6%B3%95"><span class="post-toc-text">量词语法</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#shopt-%E5%91%BD%E4%BB%A4%E5%92%8C%E5%8F%82%E6%95%B0"><span class="post-toc-text">shopt 命令和参数</span></a></li></ol>
            
        
        <link rel="stylesheet" type="text/css" href="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Shell 接收到用户输入的命令以后，会根据空格将用户的输入，拆分成一个个词元（token）。然后，Shell 会扩展词元里面的特殊字符，扩展完成后才会调用相应的命令。</p>
<p>这种特殊字符的扩展，称为模式扩展（globbing）。其中有些用到通配符，又称为通配符扩展（wildcard expansion）。Bash 一共提供八种扩展。</p>
<ul>
<li>波浪线扩展</li>
<li><code>?</code> 字符扩展</li>
<li><code>*</code> 字符扩展</li>
<li><code>$</code>字符扩展</li>
<li>方括号扩展</li>
<li>大括号扩展</li>
<li>字符类扩展</li>
</ul>
<p>模式扩展与正则表达式的关系是，模式扩展早于正则表达式出现，可以看作是原始的正则表达式。它的功能没有正则那么强大灵活，但是优点是简单和方便。</p>
<p>Bash 允许用户关闭扩展。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">set</span> -o <span class="built_in">noglob</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ <span class="built_in">set</span> -f</span><br></pre></td></tr></table></figure>

<p>下面的命令可以重新打开扩展。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">set</span> +o <span class="built_in">noglob</span></span><br><span class="line"><span class="comment"># 或者</span></span><br><span class="line">$ <span class="built_in">set</span> +f</span><br></pre></td></tr></table></figure>

<h2 id="字符扩展"><a href="#字符扩展" class="headerlink" title="~字符扩展"></a><code>~</code>字符扩展</h2><p><code>~</code>会自动扩展成当前用户的主目录。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@dengpangpang ~]$ <span class="built_in">echo</span> ~</span><br><span class="line">/root</span><br></pre></td></tr></table></figure>

<p><code>~/dir</code>表示扩展成主目录的某个子目录，<code>dir</code>是主目录里面的一个子目录名。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@dengpangpang ~]$ <span class="built_in">echo</span> ~/test</span><br><span class="line">/root/test</span><br></pre></td></tr></table></figure>

<p><code>~user</code>表示扩展成用户<code>user</code>的主目录。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@dengpangpang ~]$ <span class="built_in">echo</span> ~www</span><br><span class="line">/home/www</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果 ~user 的 user 是不存在的用户名，则波浪号扩展不起作用。</span></span><br><span class="line">[root@dengpangpang ~]$ <span class="built_in">echo</span> ~wwww</span><br><span class="line">~wwww</span><br></pre></td></tr></table></figure>

<p><code>~+</code>会扩展成当前所在的目录，等同于<code>pwd</code>命令。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@dengpangpang nginx]$ <span class="built_in">echo</span> ~+</span><br><span class="line">/etc/nginx</span><br></pre></td></tr></table></figure>

<h2 id="字符扩展-1"><a href="#字符扩展-1" class="headerlink" title="? 字符扩展"></a><code>?</code> 字符扩展</h2><p><code>?</code>字符代表文件路径里面的任意单个字符，不包括空字符。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存在文件 a.txt 和 b.txt</span></span><br><span class="line">$ <span class="built_in">ls</span> ?.txt</span><br><span class="line">a.txt b.txt</span><br></pre></td></tr></table></figure>

<p>如果匹配多个字符，就需要多个<code>?</code>连用。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存在文件 a.txt、b.txt 和 ab.txt</span></span><br><span class="line">$ <span class="built_in">ls</span> ??.txt</span><br><span class="line">ab.txt</span><br></pre></td></tr></table></figure>

<p><code>?</code> 字符扩展属于文件名扩展，只有文件确实存在的前提下，才会发生扩展。如果文件不存在，扩展就不会发生。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当前目录为空目录</span></span><br><span class="line">$ <span class="built_in">echo</span> ?.txt</span><br><span class="line">?.txt</span><br></pre></td></tr></table></figure>

<p>上面例子中，如果<code>?.txt</code>可以扩展成文件名，<code>echo</code>命令会输出扩展后的结果；如果不能扩展成文件名，<code>echo</code>就会原样输出<code>?.txt</code>。</p>
<h2 id="字符扩展-2"><a href="#字符扩展-2" class="headerlink" title="* 字符扩展"></a><code>*</code> 字符扩展</h2><p><code>*</code>字符代表文件路径里面的任意数量的任意字符，包括零个字符。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存在文件 a.txt、b.txt 和 ab.txt</span></span><br><span class="line">$ <span class="built_in">ls</span> *.txt</span><br><span class="line">a.txt b.txt ab.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 也可以匹配空字符</span></span><br><span class="line">$ <span class="built_in">ls</span> a*.txt</span><br><span class="line">a.txt ab.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果想输出当前目录的所有文件，直接用 * 即可</span></span><br><span class="line">$ <span class="built_in">ls</span> *</span><br></pre></td></tr></table></figure>

<p>注意：上面的例子，如果文本文件在子目录，<code>*.txt</code>不会产生匹配，必须写成<code>*/*.txt</code>。有几层子目录，就必须写几层星号。</p>
<h2 id="字符扩展-3"><a href="#字符扩展-3" class="headerlink" title="$字符扩展"></a><code>$</code>字符扩展</h2><h3 id="变量扩展"><a href="#变量扩展" class="headerlink" title="变量扩展"></a>变量扩展</h3><p>Bash 将美元符号<code>$</code>开头的词元视为变量，将其扩展成变量值，详见《Bash 变量》一章。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$SHELL</span></span><br><span class="line">/bin/bash</span><br></pre></td></tr></table></figure>

<p>变量名也可以放在{}里面，${SHELL}同样表示变量，也同样可以扩展。</p>
<p><code>!</code>表示间接引用。<code>$&#123;!string*&#125;</code>或<code>$&#123;!string@&#125;</code>返回所有匹配给定字符串<code>string</code>的变量名。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面例子,`$&#123;!S*&#125;`扩展成所有以`S`开头的变量名。</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;!S*&#125;</span></span><br><span class="line">SECONDS SHELL SHELLOPTS SHLVL SSH_AGENT_PID SSH_AUTH_SOCK</span><br></pre></td></tr></table></figure>

<h3 id="子命令扩展"><a href="#子命令扩展" class="headerlink" title="子命令扩展"></a>子命令扩展</h3><p><code>$(...)</code>可以扩展成另一个命令的运行结果，该命令的所有输出都会作为返回值。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面例子中，$(date)返回`date`命令的运行结果。</span></span><br><span class="line">$ <span class="built_in">echo</span> $(<span class="built_in">date</span>)</span><br><span class="line">Tue Jan 28 00:01:13 CST 2020</span><br></pre></td></tr></table></figure>

<p>还有另一种较老的语法，子命令放在反引号之中，也可以扩展成命令的运行结果。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> `<span class="built_in">date</span>`</span><br><span class="line">Tue Jan 28 00:01:13 CST 2020</span><br></pre></td></tr></table></figure>

<p><code>$(...)</code>可以嵌套，比如<code>$(ls $(pwd))</code>。</p>
<h3 id="算术扩展"><a href="#算术扩展" class="headerlink" title="算术扩展"></a>算术扩展</h3><p><code>$((...))</code>可以扩展成整数运算的结果，详见《Bash 的算术运算》一章。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> $((<span class="number">2</span> + <span class="number">2</span>))</span><br><span class="line">4</span><br></pre></td></tr></table></figure>

<h2 id="扩展"><a href="#扩展" class="headerlink" title="[]扩展"></a><code>[]</code>扩展</h2><h3 id="abc-扩展"><a href="#abc-扩展" class="headerlink" title="[abc]扩展"></a><code>[abc]</code>扩展</h3><p>方括号扩展的形式是<code>[...]</code>，括号之中的任意一个字符。比如，<code>[aeiou]</code>可以匹配五个元音字母中的任意一个。<br>(只有文件确实存在的前提下才会扩展。如果文件不存在，就会原样输出)</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存在文件 a.txt 和 b.txt</span></span><br><span class="line">$ <span class="built_in">ls</span> [ab].txt</span><br><span class="line">a.txt b.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只存在文件 a.txt。如果文件不存在`[ab].txt`就原样输出，会导致`ls`命名报错：不存在的文件或目录</span></span><br><span class="line">$ <span class="built_in">ls</span> [ab].txt</span><br><span class="line">a.txt</span><br></pre></td></tr></table></figure>

<p>方括号扩展还有两种变体：<code>[^...]</code>和<code>[!...]</code>，这两种写法是等价的，它们表示匹配不在方括号里面的字符。</p>
<p>比如，<code>[^abc]</code>或<code>[!abc]</code>表示匹配除了<code>a</code>、<code>b</code>、<code>c</code>以外的字符。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存在 aaa、bbb、aba 三个文件,[!a]表示文件名第二个字符不是a的文件名，所以返回了aba和bbb两个文件。</span></span><br><span class="line">$ <span class="built_in">ls</span> ?[!a]?</span><br><span class="line">aba bbb</span><br></pre></td></tr></table></figure>

<p>注意，如果需要匹配<code>[</code>字符，可以放在方括号内，比如<code>[[aeiou]</code>。如果需要匹配连字号<code>-</code>，只能放在方括号内部的开头或结尾，比如<code>[-aeiou]</code>或<code>[aeiou-]</code>。</p>
<h3 id="start-end-扩展"><a href="#start-end-扩展" class="headerlink" title="[start-end]扩展"></a><code>[start-end]</code>扩展</h3><p>方括号扩展有一个简写形式<code>[start-end]</code>，表示匹配一个连续的范围。比如，<code>[a-c]</code>等同于<code>[abc]</code>，<code>[0-9]</code>匹配<code>[0123456789]</code>。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存在文件 a.txt、b.txt 和 c.txt</span></span><br><span class="line">$ <span class="built_in">ls</span> [a-c].txt</span><br><span class="line">a.txt</span><br><span class="line">b.txt</span><br><span class="line">c.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存在文件 report1.txt、report2.txt 和 report3.txt</span></span><br><span class="line">$ <span class="built_in">ls</span> report[0-9].txt</span><br><span class="line">report1.txt</span><br><span class="line">report2.txt</span><br><span class="line">report3.txt</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>下面是一些常用简写的例子。</p>
<ul>
<li><code>[a-z]</code>：所有小写字母。</li>
<li><code>[a-zA-Z0-9]</code>：所有小写字母、大写字母与数字。</li>
<li><code>[abc]*</code>：所有以<code>a</code>、<code>b</code>、<code>c</code>字符之一开头的文件名。</li>
<li><code>BACKUP.[0-9][0-9][0-9]</code>：所有以<code>BACKUP.</code>开头，后面是三个数字的文件名。</li>
</ul>
<p>这种简写形式有一个否定形式<code>[!start-end]</code>，表示匹配不属于这个范围的字符。比如，<code>[!a-zA-Z]</code>表示匹配非英文字母的字符。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> report[!1–3].txt</span><br><span class="line">report4.txt report5.txt</span><br></pre></td></tr></table></figure>

<h2 id="扩展-1"><a href="#扩展-1" class="headerlink" title="{}扩展"></a><code>&#123;&#125;</code>扩展</h2><h3 id="a-b-c-扩展"><a href="#a-b-c-扩展" class="headerlink" title="{a,b,c}扩展"></a><code>&#123;a,b,c&#125;</code>扩展</h3><p>大括号扩展<code>&#123;...&#125;</code>表示分别扩展成大括号里面的所有值，各个值之间使用逗号分隔。比如，<code>&#123;1,2,3&#125;</code>扩展成<code>1 2 3</code>。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> &#123;1,2,3&#125;</span><br><span class="line">1 2 3</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">echo</span> d&#123;a,e,i,u,o&#125;g</span><br><span class="line">dag deg dig dug dog</span><br></pre></td></tr></table></figure>

<p>注意，大括号扩展不是文件名扩展。它会扩展成所有给定的值，而不管是否有对应的文件存在。</p>
<p>另一个需要注意的地方是，大括号内部的逗号前后不能有空格。否则，大括号扩展会失效。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 逗号前后有空格，Bash 就会认为这不是大括号扩展，而是三个独立的参数</span></span><br><span class="line">$ <span class="built_in">echo</span> &#123;1 , 2&#125;</span><br><span class="line">&#123;1 , 2&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逗号前面可以没有值，表示扩展的第一项为空。</span></span><br><span class="line">$ <span class="built_in">cp</span> a.log&#123;,.bak&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等同于`cp a.log a.log.bak`</span></span><br></pre></td></tr></table></figure>

<p>大括号可以嵌套。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> &#123;j&#123;p,pe&#125;g,png&#125;</span><br><span class="line">jpg jpeg png</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">echo</span> a&#123;A&#123;1,2&#125;,B&#123;3,4&#125;&#125;b</span><br><span class="line">aA1b aA2b aB3b aB4b</span><br></pre></td></tr></table></figure>

<p>大括号也可以与其他模式联用，并且总是先于其他模式进行扩展。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> /bin/&#123;<span class="built_in">cat</span>,b*&#125;</span><br><span class="line">/bin/cat /bin/b2sum /bin/base32 /bin/base64 ... ...</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基本等同于`echo /bin/cat;echo /bin/b*`</span></span><br></pre></td></tr></table></figure>

<h3 id="start-end-扩展-1"><a href="#start-end-扩展-1" class="headerlink" title="{start..end}扩展"></a><code>&#123;start..end&#125;</code>扩展</h3><p>大括号扩展有一个简写形式<code>&#123;start..end&#125;</code>，表示扩展成一个连续序列。</p>
<p>比如，<code>&#123;a..z&#125;</code>可以扩展成26个小写英文字母。这种简写形式同样支持逆序，比如<code>&#123;z..a&#125;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> &#123;a..c&#125;</span><br><span class="line">a b c</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">echo</span> d&#123;a..d&#125;g</span><br><span class="line">dag dbg dcg ddg</span><br></pre></td></tr></table></figure>

<p>注意，如果遇到无法理解的简写，大括号模式就会原样输出，不会扩展。</p>
<p>这种简写形式可以嵌套使用，形成复杂的扩展。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 大括号扩展的常见用途为新建一系列目录,下面的命令会建立36个目录</span></span><br><span class="line">$ <span class="built_in">mkdir</span> &#123;2007..2009&#125;-&#123;01..12&#125;</span><br></pre></td></tr></table></figure>

<p>这个写法的另一个常见用途，是直接用于<code>for</code>循环。下面例子会循环4次。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> &#123;1..4&#125;</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>这种简写形式还可以使用第二个双点号（<code>start..end..step</code>），用来指定扩展的步长。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下面代码将0扩展到8，每次递增的长度为2，所以一共输出5个数字。</span></span><br><span class="line">$ <span class="built_in">echo</span> &#123;0..8..2&#125;</span><br><span class="line">0 2 4 6 8</span><br></pre></td></tr></table></figure>

<h2 id="字符类扩展"><a href="#字符类扩展" class="headerlink" title="字符类扩展"></a>字符类扩展</h2><p><code>[[:class:]]</code>表示一个字符类，扩展成某一类特定字符之中的一个。常用的字符类如下。</p>
<ul>
<li><code>[[:alnum:]]</code>：匹配任意英文字母与数字</li>
<li><code>[[:alpha:]]</code>：匹配任意英文字母</li>
<li><code>[[:blank:]]</code>：空格和 Tab 键。</li>
<li><code>[[:cntrl:]]</code>：ASCII 码 0-31 的不可打印字符。</li>
<li><code>[[:digit:]]</code>：匹配任意数字 0-9。</li>
<li><code>[[:graph:]]</code>：A-Z、a-z、0-9 和标点符号。</li>
<li><code>[[:lower:]]</code>：匹配任意小写字母 a-z。</li>
<li><code>[[:print:]]</code>：ASCII 码 32-127 的可打印字符。</li>
<li><code>[[:punct:]]</code>：标点符号（除了 A-Z、a-z、0-9 的可打印字符）。</li>
<li><code>[[:space:]]</code>：空格、Tab、LF（10）、VT（11）、FF（12）、CR（13）。</li>
<li><code>[[:upper:]]</code>：匹配任意大写字母 A-Z。</li>
<li><code>[[:xdigit:]]</code>：16进制字符（A-F、a-f、0-9）。</li>
</ul>
<p>字符类的第一个方括号后面，可以加上感叹号<code>!</code>，表示否定。比如，<code>[![:digit:]]</code>匹配所有非数字。</p>
<p>字符类也属于文件名扩展，如果没有匹配的文件名，字符类就会原样输出。</p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>通配符有一些使用注意点，不可不知。</p>
<p><strong>（1）通配符是先解释，再执行。</strong></p>
<p>Bash 接收到命令以后，发现里面有通配符，会进行通配符扩展，然后再执行命令。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> a*.txt</span><br><span class="line">ab.txt</span><br></pre></td></tr></table></figure>

<p>上面命令的执行过程是，Bash 先将<code>a*.txt</code>扩展成<code>ab.txt</code>，然后再执行<code>ls ab.txt</code>。</p>
<p><strong>（2）文件名扩展在不匹配时，会原样输出。</strong></p>
<p>文件名扩展在没有可匹配的文件时，会原样输出。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不存在 r 开头的文件名</span></span><br><span class="line">$ <span class="built_in">echo</span> r*</span><br><span class="line">r*</span><br></pre></td></tr></table></figure>

<p>上面代码中，由于不存在<code>r</code>开头的文件名，<code>r*</code>会原样输出。</p>
<p>下面是另一个例子。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> *.csv</span><br><span class="line"><span class="built_in">ls</span>: *.csv: No such file or directory</span><br></pre></td></tr></table></figure>

<p>另外，前面已经说过，大括号扩展<code>&#123;...&#125;</code>不是文件名扩展。</p>
<p><strong>（3）只适用于单层路径。</strong></p>
<p>所有文件名扩展只匹配单层路径，不能跨目录匹配，即无法匹配子目录里面的文件。或者说，<code>?</code>或<code>*</code>这样的通配符，不能匹配路径分隔符（<code>/</code>）。</p>
<p>如果要匹配子目录里面的文件，可以写成下面这样。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">ls</span> */*.txt</span><br></pre></td></tr></table></figure>

<p>Bash 4.0 新增了一个<code>globstar</code>参数，允许<code>**</code>匹配零个或多个子目录，详见后面<code>shopt</code>命令的介绍。</p>
<p><strong>（4）文件名可以使用通配符。</strong></p>
<p>Bash 允许文件名使用通配符，即文件名包括特殊字符。这时引用文件名，需要把文件名放在单引号或双引号里面。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">touch</span> <span class="string">&#x27;fo*&#x27;</span></span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">fo*</span><br></pre></td></tr></table></figure>

<p>上面代码创建了一个<code>fo*</code>文件，这时<code>*</code>就是文件名的一部分。</p>
<h2 id="量词语法"><a href="#量词语法" class="headerlink" title="量词语法"></a>量词语法</h2><p>量词语法用来控制模式匹配的次数。</p>
<p>量词语法只有在 Bash 的<code>extglob</code>参数打开的情况下才能使用，不过一般是默认打开的。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询量词语法是否开启</span></span><br><span class="line">$ <span class="built_in">shopt</span> extglob</span><br><span class="line">extglob        	on</span><br><span class="line"></span><br><span class="line"><span class="comment"># 开启量词语法</span></span><br><span class="line">$ <span class="built_in">shopt</span> -s extglob</span><br></pre></td></tr></table></figure>

<p>量词语法有下面几个，注意下面作为量词语法的<code>?</code>或者<code>*</code>之类的字符，与前面的字符扩展没有关系</p>
<ul>
<li><code>?(pattern-list)</code>：模式匹配零次或一次。</li>
<li><code>*(pattern-list)</code>：模式匹配零次或多次。</li>
<li><code>+(pattern-list)</code>：模式匹配一次或多次。</li>
<li><code>@(pattern-list)</code>：只匹配一次模式。</li>
<li><code>!(pattern-list)</code>：匹配给定模式以外的任何内容。</li>
</ul>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `?(.)`匹配零个或一个点。</span></span><br><span class="line">$ <span class="built_in">ls</span> abc?(.)txt</span><br><span class="line">abctxt abc.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># `?(def)`匹配零个或一个`def`</span></span><br><span class="line">$ <span class="built_in">ls</span> abc?(def)</span><br><span class="line">abc abcdef</span><br><span class="line"></span><br><span class="line"><span class="comment"># `@(.txt|.php)`匹配文件有且只有一个`.txt`或`.php`后缀名</span></span><br><span class="line">$ <span class="built_in">ls</span> abc@(.txt|.php)</span><br><span class="line">abc.php abc.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># `+(.txt)`匹配文件有一个或多个`.txt`后缀名</span></span><br><span class="line">$ <span class="built_in">ls</span> abc+(.txt)</span><br><span class="line">abc.txt abc.txt.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># `!(b)`表示匹配单个字母`b`以外的任意内容，所以除了`ab.txt`以外，其他文件名都能匹配</span></span><br><span class="line">$ <span class="built_in">ls</span> a!(b).txt</span><br><span class="line">a.txt abb.txt ac.txt</span><br></pre></td></tr></table></figure>

<p>量词语法也属于文件名扩展，如果不存在可匹配的文件，就会原样输出。</p>
<h2 id="shopt-命令和参数"><a href="#shopt-命令和参数" class="headerlink" title="shopt 命令和参数"></a>shopt 命令和参数</h2><p><code>shopt</code>命令可以调整 Bash 的行为。它有好几个参数跟通配符扩展有关。</p>
<p><code>shopt</code>命令的使用方法如下：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开某个参数</span></span><br><span class="line">$ <span class="built_in">shopt</span> -s [optionname]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭某个参数</span></span><br><span class="line">$ <span class="built_in">shopt</span> -u [optionname]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询某个参数关闭还是打开</span></span><br><span class="line">$ <span class="built_in">shopt</span> [optionname]</span><br></pre></td></tr></table></figure>

<p><strong>dotglob 参数</strong></p>
<p><code>dotglob</code>参数可以让扩展结果包括隐藏文件（即点开头的文件）</p>
<p><strong>nullglob 参数</strong></p>
<p><code>nullglob</code>参数可以让通配符不匹配任何文件名时，返回空字符。</p>
<p>默认情况下，通配符不匹配任何文件名时，会保持不变。打开<code>nullglob</code>参数，就可以让不匹配的通配符返回空字符串。</p>
<p><strong>failglob 参数</strong></p>
<p><code>failglob</code>参数使得通配符不匹配任何文件名时，Bash 会直接报错，而不是让各个命令去处理。</p>
<p><strong>extglob 参数</strong></p>
<p><code>extglob</code>参数使得 Bash 支持量词语法。它默认应该是打开的。</p>
<p><strong>nocaseglob 参数</strong></p>
<p><code>nocaseglob</code>参数可以让通配符扩展整体不区分大小写。比如<code>program*</code>可以匹配<code>ProgramData</code>等。</p>
<p><strong>globstar 参数</strong></p>
<p><code>globstar</code>参数可以使得<code>**</code>匹配零个或多个子目录。该参数默认是关闭的。</p>
</div><script src="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery) {
        var options1 = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1);
        }</script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2022-09-27</span>
            
                <span>该篇文章被 邓胖胖</span>
            
            
                <span>打上标签:
                    
                    
                        <a href='/tags/Bash/'>
                            Bash
                        </a>
                    
                </span>
             
             
                <span>归为分类:
                    
                    
                        <a href='/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>
                            学习笔记
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    <!-- <div class="post-footer-pre-next">
        <span>上一篇：<a href=""></a></span>
        <span class="post-footer-pre-next-last-span-right">上一篇：<a href=""></a></span>
    </div> -->

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
             

            
                

            
        </span>
    
</div>
<!--这是指一条线往下的内容-->
<div class="footer-last">
    
            <span></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--目录-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--回到顶部按钮-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery.min.js"></script>



                </div>
            
            
                <!-- 回到顶部的按钮-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- 返回的按钮-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>