---
title: 模块和包-正则表达式和re模块
date: 2023-08-15 22:39:36
tags: python
---



# 模块和包-正则表达式和re模块

## 正则表达式

正则表达式，是用语句来描述一些字符串的特征，可以与`re`模块结合，将字符串提取出来。比如：

```python
import re

text = "sdhkfsgk23874823skjfsbj34563hsdj"	# 一段任意字符串
data_list = re.findall("正则表达式", text)	 # 可以提取得到想要的字符串，组成列表
```

### 字符相关

- 固定文本

  正则表达式不含任何特殊符号，表示直接匹配固定文本

  ```python
  text = "常州大学西太湖校区常州市武进区延政西大道"
  re.findall("常州", text)		# ['常州', '常州']
  ```

- 匹配字符

  如`[sdfhd]`表示，中括号里的任一字符都在选择范围内，数量较多时可使用如`[a-z]`或`[0-9]`

  ```python
  text = "常州大学西太湖校区常州市武进区延政西大道"
  re.findall("常州[大,市]", text)		# ['常州大', '常州市']-
  ```

- `\d`代表数字

  ```python
  text = "sfkhd23394jdbdjkjd2323"
  
  # \是转义字符，\d 代表一个数字
  re.findall("d\d", text)		# ['d2', 'd2']
  ```

- `\w`表示字母、数字、下划线或汉字

  ```python
  import re
  
  text = "常州大学cczu  常州大学cczu"
  data_list = re.findall("大学\w+z",text)	
  # ['大学ccz', '大学ccz'],\w不匹配空格
  ```

  ```python
  # 正则默认是尽可能多的去匹配，称为贪婪匹配
  text = "常州大学cczu常州大学cczu"
  data_list = re.findall("大学\w+z",text)	# ['大学cczu常州大学ccz']
  
  # 非贪婪匹配是指找到第一个匹配就不要再匹配了，加上一个?即可
  text = "常州大学cczu常州大学cczu"
  data_list = re.findall("大学\w+?z",text)	# ['大学ccz', '大学ccz']
  ```

- `.`表示除换行符以外的任何字符

  ```python
  import re
  
  #  . 只代表一个字符
  text = "adshjgkalsdkfjo"
  data_list = re.findall("a.s",text)		# ['ads', 'als']
  
  # 多个字符，贪婪匹配
  text = "adshjgkalsdkfjo"
  data_list = re.findall("a.+s",text)		# ['adshjgkals']
  
  # 多个字符，非贪婪匹配
  text = "adshjgkalsdkfjo"
  data_list = re.findall("a.+?s",text)	# ['ads', 'als']	
  ```

- `\s`表示空白字符

  ```python
  import re
  
  text = "add admin    a"
  data_list = re.findall("a\w+\s+\w",text)	# ['add a'], \s后不带+只代表一个字符
  ```

### 数量相关

- `*`代表0或多个
- `+`代表1或多个
- `?`代表0或1个
- `{n}`代表固定`n`个
- `{n,}`代表`n`个及以上
- `{n,m}`代表大于等于`n`,小于等于`m`个

注意：默认贪婪匹配，非贪婪匹配需要在数量后加`?`

```python
# \d+ 代表一个或多个数字
re.findall("d\d+", text)	# ['d23394', 'd2323']

# \d* 代表0个或1个或多个
re.findall("d\d*", text)	# ['d23394', 'd', 'd', 'd2323']

# \d? 代表0个或1个，如果后面有多个数字，只取第一个
re.findall("d\d?", text)	# ['d2', 'd', 'd', 'd2', 'd1']

# \d{n} 代表固定n个，如果后面有超过n个，只取n个
re.findall("d\d{3}", text)	# ['d233', 'd232']

# \d{n,} 代表n个或n个以上
re.findall("d\d{5,}", text)	# ['d23394']

# \d{n,m} 代表大于等于n,小于等于m
re.findall("d\d{5,6}", text)	# ['d23394']

# 注意：以上的+，*，?，{}等代表次数，也可以与一般字符串搭配使用，如：
text = "aabbccccaaadddd"
res = re.findall("a+", text)	# ['aa', 'aaa']
```

### 分组

- 提取部分区域的数据

  ```python
  import re
  
  # 将目标区域用()围住即可，()不影响正则表达式的整体含义
  text = "手机号17633554278中国联通"
  data_list = re.findall("1\d{6}(\d{4})",text)		# ['4278']
  
  # 当要提取多个部分时，或存在区域包含关系时，仍然可用
  data_list = re.findall("((1\d{2})\d{4}(\d{4}))",text)	
  # [('17633554278', '176', '4278')]
  ```

- "或"的关系

  ```python
  import re
  
  # 用()围住的部分中，可以存在"或"的关系,用|实现
  text = "手机号17633554278和手机号17633554273都是我名下的，后面那个送人了"
  data_list = re.import("1\d{6}427(8|3)",text)	# ['8', '3']
  ```

- 限制开头和结尾

  ```python
  # 在正则表达式的开头加上 ^ ,在结尾加上 $ ,表示严格限制文本的开头和结尾，常用于文本校验
  import re
  
  text = input("请输入手机号：")		
  res = re.match("^1[3-9]\d{9}$", text)	# 只能输入符合要求的11位数，后续不能存在更多字符
  ```

### 应用

- 企鹅号

- 手机号

  ```python
  # 手机号格式："1[3-9]\d{9}"
  ```

- 身份证号

- 邮箱

  ```python
  """
  一般邮箱格式：xxx@xxx.com
  正则表达式出现的 . 代表的是除换行符外的一个任意字符,当需要表示字符 . 时，用 \. 
  """
  import re
  
  text = "我的126邮箱是dengjinjun0805@126.com，QQ邮箱是498790885@qq.com"
  data_list = re.findall("\w+@\w+\.com", text, re.ASCII)	# re.ASCII让\w不匹配中文
  print(data_list)	# ['dengjinjun0805@126.com', '498790885@qq.com']
  
  # 对于较为复杂的支持 - 和 _ 以及域名为cn或en等的邮箱，可以使用如下语句
  data_list = re.findall("[a-zA-Z0-9-_]+@[a-zA-Z0-9-_]+\.[a-zA-Z0-9-_]+"，text)
  ```

## re模块

- 获取所有匹配成功的结果

  ```python
  re.findall("正则表达式", "文本")	# 在正则表达式中已介绍
  ```

- 从字符串开头进行匹配，返回第一个对象

  使用`re.match()`对字符串开头第一个字符开始匹配，如果开头不匹配不会继续寻找。

  ```python
  import re
  
  text = "changzhou university"
  res = re.match("u\w+y", text)	# None
  res = re.match("c\w+\s", text)	# <re.Match object; span=(0, 10), match='changzhou '>
  # 得到的是一个re.match类型的对象，可以通过group()方法获得
  # 为了防止匹配失败得到空对象，然后使用group方法时报错，一般需要添加判断条件
  if res:
  	content = res.group()			# changzhou
  ```

- 从整个字符串进行匹配，返回第一个对象

  使用`re.search()`对整个字符串进行匹配，返回第一个对象，与`re.match()`不同的是，开头不匹配，仍然会继续寻找，找到后返回一个对象，通过`group()`方法获取，否则返回`None`

  ```python
  import re
  
  text = "changzhou university"
  res = re.search("u\w+y", text)	# <re.Match object; span=(10, 20), match='university'>
  if res:
      content = res.group()	# university
  ```

- 字符串的分割

  使用`re.split()`对字符串进行分割，一般的字符串分割只能按照一个字符进行分割，而利用正则表达式，可以实现按照不同的字符进行分割，比如:

  ```python
  import re
  
  text = "23+34-5"
  data_lsit = re.split("[+-]", text)	# ['23', '34', '5']
  ```

  