<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="K8sæ¦‚è¿°" />
    <meta name="hexo-theme-A4" content="v1.9.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Dengpangpang</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Dengpangpang</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">ğŸŸé¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">ğŸ“æ–‡ç« </a></li>
            
        
            
                <li><a href="/tags/">ğŸ·ï¸æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">ğŸ—‚ï¸åˆ†ç±»</a></li>
            
        
            
                <li><a href="/about/">ğŸ‘ï¸å…³äº</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            K8sæ¦‚è¿°
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#K8s%E6%9E%B6%E6%9E%84"><span class="post-toc-text">K8sæ¶æ„</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Master-Node"><span class="post-toc-text">Master Node</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Worker-Node"><span class="post-toc-text">Worker Node</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#K8s%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="post-toc-text">K8såŸºæœ¬å·¥ä½œæµç¨‹</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#K8s%E9%83%A8%E7%BD%B2"><span class="post-toc-text">K8séƒ¨ç½²</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Master%E9%83%A8%E7%BD%B2"><span class="post-toc-text">Masteréƒ¨ç½²</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Node%E9%83%A8%E7%BD%B2"><span class="post-toc-text">Nodeéƒ¨ç½²</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%BD%91%E7%BB%9C%E6%8F%92%E4%BB%B6%E9%83%A8%E7%BD%B2"><span class="post-toc-text">ç½‘ç»œæ’ä»¶éƒ¨ç½²</span></a></li></ol></li></ol>
            
        
        <link rel="stylesheet" type="text/css" href="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/css/lightgallery.min.css" /><div class=".article-gallery"><p>Kubernetesç®€ç§°k8sï¼Œæ˜¯ç”¨äºç®¡ç†å®¹å™¨åŒ–åº”ç”¨ç¨‹åºé›†ç¾¤çš„å·¥å…·ï¼Œæ˜¯ä¸€ä¸ªå®¹å™¨ç¼–æ’å·¥å…·ã€‚</p>
<p>è¯´èµ·å®¹å™¨ç¼–æ’ï¼ŒåƒDockerçš„Composeæˆ–è€…æ˜¯Docker-Swarméƒ½æä¾›äº†ç®€å•çš„å®¹å™¨ç¼–æ’çš„èƒ½åŠ›ï¼Œå®ƒä»¬çš„é€šç—…å°±æ˜¯è¿‡äºä»¥Dockeræ ¸å¿ƒï¼Œæä¾›çš„èƒ½åŠ›ä¹Ÿè¿‡äºç®€å•æ¯”å¦‚å®šä¹‰è°å…ˆå¯åŠ¨è°åå¯åŠ¨ï¼Œæ— æ³•æ»¡è¶³æ¯”è¾ƒå¤æ‚çš„åœºæ™¯ã€‚è€ŒK8Sçš„å®¹å™¨ç¼–æ’è®¾è®¡æ˜¯ç«™åœ¨æ›´é«˜çš„ç»´åº¦ï¼Œå¯ä»¥åè°ƒåœ°å°†è®¸å¤šå¾®æœåŠ¡ç»„åˆåœ¨ä¸€èµ·æ„æˆäº†åº”ç”¨ç¨‹åºï¼Œå¹¶ä¸”è‡ªåŠ¨ä¸”æŒç»­åœ°ç›‘è§†é›†ç¾¤å¹¶å¯¹å…¶ç»„æˆè¿›è¡Œè°ƒæ•´ã€‚</p>
<h2 id="K8sæ¶æ„"><a href="#K8sæ¶æ„" class="headerlink" title="K8sæ¶æ„"></a>K8sæ¶æ„</h2><p><strong>å¾ˆé‡è¦çš„æ¶æ„å›¾</strong></p>
<p>Master Nodeæ˜¯ä¸»èŠ‚ç‚¹ï¼Œå®ƒè´Ÿè´£ç®¡ç†Worker Nodeï¼ˆå·¥ä½œèŠ‚ç‚¹ï¼‰ã€‚Master Node é€šè¿‡API Serverä»CLIï¼ˆå‘½ä»¤è¡Œç•Œé¢ï¼‰æˆ–UIï¼ˆç”¨æˆ·ç•Œé¢ï¼‰æ¥æ”¶å‘½ä»¤è¾“å…¥ã€‚åœ¨ç”Ÿäº§ä¸­é€šå¸¸ä¼šæœ‰å¤šä¸ªMaster Nodeä»¥å®ç°K8sç³»ç»ŸæœåŠ¡é«˜å¯ç”¨ã€‚</p>
<p>å…¶å®K8så®˜æ–¹å¹¶æ²¡æœ‰Master Nodeè¿™ä¸€è¯´ï¼Œåªæ˜¯å¤§å¤šæ•°å®‰è£…å·¥å…·ï¼ˆkubeadmï¼‰æˆ–è€…è„šæœ¬ä¸ºäº†æ¶æ„æ›´æ˜äº†ä¼šæŠŠæ‰€æœ‰ç»„ä»¶å®‰è£…åˆ°ä¸€å°æœºå™¨ä¸Šå³Masteræœºå™¨ï¼Œå¹¶ä¸”ä¸ä¼šåœ¨æ­¤æœºå™¨ä¸Šè¿è¡Œç”¨æˆ·å®¹å™¨ã€‚ è¿™ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥å¯¹è¿™äº›æ§åˆ¶ç»„ä»¶å®è¡Œåˆ†å¸ƒå¼éƒ¨ç½²ï¼Œä¸è¿‡è¿™æ ·çš„è¯é«˜å¯ç”¨ä¼šæ˜¯ä¸€ä¸ªä¸å°çš„æŒ‘æˆ˜ã€‚</p>
<p><a href="/../pic/1460000022973860.png" title="æ ‡å‡†kubernetesé›†ç¾¤çš„æ¶æ„å›¾" class="gallery-item" style="box-shadow: none;"> <img src="/../pic/1460000022973860.png" alt="æ ‡å‡†kubernetesé›†ç¾¤çš„æ¶æ„å›¾"></a></p>
<h3 id="Master-Node"><a href="#Master-Node" class="headerlink" title="Master Node"></a>Master Node</h3><p>åœ¨Master Nodeä¸Šé€šå¸¸åŒ…æ‹¬ API Serverã€etcd å­˜å‚¨ã€Controller-managerã€Schedulerã€cloud-controller-managerï¼ˆäº‘æ§åˆ¶ä¸­å¿ƒï¼Œå¯é€‰ï¼Œç”¨äºäº‘äº§å“ï¼‰å’Œç”¨äº K8s æœåŠ¡çš„ DNS æœåŠ¡å™¨ï¼ˆæ’ä»¶ï¼‰ã€‚</p>
<blockquote>
<p><strong>API Server</strong></p>
</blockquote>
<p>API Serveræ˜¯ç”¨æˆ·å”¯ä¸€å¯ä»¥ç›´æ¥è¿›è¡Œäº¤äº’çš„K8sç»„ä»¶ï¼Œå®ƒä¸ºK8sé›†ç¾¤èµ„æºæ“ä½œæä¾›å”¯ä¸€å…¥å£ï¼Œå¹¶æä¾›è®¤è¯ã€æˆæƒã€è®¿é—®æ§åˆ¶ã€API æ³¨å†Œå’Œå‘ç°æœºåˆ¶ã€‚</p>
<blockquote>
<p><strong>ControllerManager</strong></p>
</blockquote>
<p>ControllerManageræ˜¯æ§åˆ¶å™¨ï¼Œå®ƒå¯ä»¥å®æ—¶ç›‘æ§é›†ç¾¤ä¸­å¦‚Serviceç­‰å„ç§èµ„æºçš„çŠ¶æ€å˜åŒ–ï¼Œä¸æ–­å°è¯•å°†å®ƒä»¬ç»´æŒåœ¨ä¸€ä¸ªæœŸæœ›çš„çŠ¶æ€ã€‚</p>
<p>k8såœ¨åå°è¿è¡Œè®¸å¤šä¸åŒçš„æ§åˆ¶å™¨è¿›ç¨‹ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li><p>èŠ‚ç‚¹æ§åˆ¶å™¨ï¼ˆNode Controllerï¼‰: è´Ÿè´£åœ¨èŠ‚ç‚¹å‡ºç°æ•…éšœæ—¶è¿›è¡Œé€šçŸ¥å’Œå“åº”</p>
</li>
<li><p>ä»»åŠ¡æ§åˆ¶å™¨ï¼ˆJob controllerï¼‰: ç›‘æµ‹ä»£è¡¨ä¸€æ¬¡æ€§ä»»åŠ¡çš„ Job å¯¹è±¡ï¼Œç„¶ååˆ›å»º Pods æ¥è¿è¡Œè¿™äº›ä»»åŠ¡ç›´è‡³å®Œæˆ</p>
</li>
<li><p>ç«¯ç‚¹æ§åˆ¶å™¨ï¼ˆEndpoints Controllerï¼‰: å¡«å……ç«¯ç‚¹(Endpoints)å¯¹è±¡(å³åŠ å…¥ Service ä¸ Pod)</p>
</li>
<li><p>æœåŠ¡å¸æˆ·å’Œä»¤ç‰Œæ§åˆ¶å™¨ï¼ˆService Account &amp; Token Controllersï¼‰: ä¸ºæ–°çš„å‘½åç©ºé—´åˆ›å»ºé»˜è®¤å¸æˆ·å’Œ API è®¿é—®ä»¤ç‰Œ</p>
</li>
</ul>
<p>ä»é€»è¾‘ä¸Šè®²ï¼Œæ¯ä¸ªæ§åˆ¶å™¨éƒ½æ˜¯ä¸€ä¸ªå•ç‹¬çš„è¿›ç¨‹ï¼Œ ä½†æ˜¯ä¸ºäº†é™ä½å¤æ‚æ€§ï¼Œå®ƒä»¬éƒ½è¢«ç¼–è¯‘åˆ°åŒä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¹¶åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­è¿è¡Œã€‚</p>
<blockquote>
<p><strong>cloud-controller-manager</strong></p>
</blockquote>
<p>cloud-controller-manageræ˜¯äº‘æ§åˆ¶å™¨ï¼Œæ˜¯å¯é€‰çš„ç»„ä»¶ï¼Œå®ƒå¯ä»¥å°†é›†ç¾¤è¿æ¥åˆ°äº‘æä¾›å•†çš„ API ä¹‹ä¸Šï¼Œå¤§å¤šæ•°éæ··åˆçš„äº‘ç¯å¢ƒæ˜¯ç”¨ä¸åˆ°è¿™ä¸ªç»„ä»¶çš„ã€‚å®ƒä¸ControllerManagerç±»ä¼¼ï¼Œå°†è‹¥å¹²é€»è¾‘ä¸Šç‹¬ç«‹çš„æ§åˆ¶å›è·¯ç»„åˆåˆ°åŒä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œä»¥åŒä¸€è¿›ç¨‹çš„æ–¹å¼è¿è¡Œã€‚</p>
<blockquote>
<p><strong>kube-scheduler</strong></p>
</blockquote>
<p>kube-scheduleræ˜¯è°ƒåº¦å™¨ï¼Œ è´Ÿè´£ç›‘è§†æ–°åˆ›å»ºã€æœªæŒ‡å®šè¿è¡ŒNodeçš„ Podsï¼Œå†³ç­–å‡ºä¸€ä¸ªè®©podè¿è¡Œçš„èŠ‚ç‚¹ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœåº”ç”¨ç¨‹åºéœ€è¦ 1GB å†…å­˜å’Œ 2 ä¸ª CPU å†…æ ¸ï¼Œé‚£ä¹ˆè¯¥åº”ç”¨ç¨‹åºçš„ pod å°†è¢«å®‰æ’åœ¨è‡³å°‘å…·æœ‰è¿™äº›èµ„æºçš„èŠ‚ç‚¹ä¸Šã€‚æ¯æ¬¡éœ€è¦è°ƒåº¦ pod æ—¶ï¼Œè°ƒåº¦ç¨‹åºéƒ½ä¼šè¿è¡Œã€‚è°ƒåº¦ç¨‹åºå¿…é¡»çŸ¥é“å¯ç”¨çš„æ€»èµ„æºä»¥åŠåˆ†é…ç»™æ¯ä¸ªèŠ‚ç‚¹ä¸Šç°æœ‰å·¥ä½œè´Ÿè½½çš„èµ„æºã€‚</p>
<p>è°ƒåº¦å†³ç­–è€ƒè™‘çš„å› ç´ åŒ…æ‹¬å•ä¸ª Pod å’Œ Pod é›†åˆçš„èµ„æºéœ€æ±‚ã€ç¡¬ä»¶&#x2F;è½¯ä»¶&#x2F;ç­–ç•¥çº¦æŸã€äº²å’Œæ€§å’Œåäº²å’Œæ€§è§„èŒƒã€æ•°æ®ä½ç½®ã€å·¥ä½œè´Ÿè½½é—´çš„å¹²æ‰°å’Œæœ€åæ—¶é™ã€‚</p>
<blockquote>
<p><strong>etcd</strong></p>
</blockquote>
<p>etcd æ˜¯å…¼å…·ä¸€è‡´æ€§å’Œé«˜å¯ç”¨æ€§çš„é”®å€¼æ•°æ®åº“ï¼Œå¯ä»¥ä½œä¸ºä¿å­˜ K8s æ‰€æœ‰é›†ç¾¤æ•°æ®çš„åå°æ•°æ®åº“ã€‚ åœ¨ç”Ÿäº§çº§k8sä¸­çš„etcdé€šå¸¸ä¼šä»¥é›†ç¾¤çš„æ–¹å¼å­˜åœ¨ï¼Œå®‰å…¨åŸå› ï¼Œå®ƒåªèƒ½ä» API æœåŠ¡å™¨è®¿é—®ã€‚</p>
<h3 id="Worker-Node"><a href="#Worker-Node" class="headerlink" title="Worker Node"></a>Worker Node</h3><p>å’ŒMasterNodeç±»ä¼¼ï¼ŒWorkerNodeæœ¬è´¨ä¹Ÿå¹¶ä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åº”ç”¨ç¨‹åºï¼Œå®ƒåŒ…å« Kubelet ã€kube-porxy ä»¥åŠæœåŠ¡äºpodçš„å®¹å™¨è¿è¡Œæ—¶(runtime)ã€‚å½“ç„¶ä¹Ÿä¼šæœ‰å¤–éƒ¨storageä¸registryç”¨äºä¸ºå®¹å™¨æä¾›å­˜å‚¨ä¸é•œåƒä»“åº“æœåŠ¡ã€‚</p>
<blockquote>
<p><strong>kubelet</strong></p>
</blockquote>
<p>kubeletæ˜¯é›†ç¾¤ä¸­æ¯ä¸ªWorker Nodeä¸Šéƒ½è¿è¡Œçš„ä»£ç†ã€‚å®ƒç›‘è§†ä»API Serverå‘é€æ¥çš„ä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡å¹¶æŠ¥å‘Šç»™ä¸»èŠ‚ç‚¹ã€‚å®ƒè¿˜ä¼šç›‘è§†Podï¼Œç¡®ä¿ pod åŠå®¹å™¨å¥åº·å¹¶ä»¥æ‰€éœ€çŠ¶æ€è¿è¡Œã€‚è¯¥ç»„ä»¶è¿˜å‘ API Server æŠ¥å‘Šè¿è¡Œå®ƒçš„ä¸»æœºçš„å¥åº·çŠ¶å†µã€‚</p>
<p>kubelet ä¸ä¼šç®¡ç†ä¸æ˜¯ç”± K8s åˆ›å»ºçš„å®¹å™¨ã€‚</p>
<blockquote>
<p><strong>kube-proxy</strong></p>
</blockquote>
<p>kube-proxyæ˜¯é›†ç¾¤ä¸­æ¯ä¸ªWorker Nodeä¸Šéƒ½è¿è¡Œçš„ç½‘ç»œä»£ç†ã€‚å®ƒç”¨äºå¤„ç†å•ä¸ªä¸»æœºå­ç½‘åˆ’åˆ†å¹¶å‘å¤–éƒ¨å…¬å¼€æœåŠ¡ã€‚</p>
<p>kube-proxy ç»´æŠ¤èŠ‚ç‚¹ä¸Šçš„ç½‘ç»œè§„åˆ™ã€‚è¿™äº›ç½‘ç»œè§„åˆ™å…è®¸ä»é›†ç¾¤å†…éƒ¨æˆ–å¤–éƒ¨çš„ç½‘ç»œä¼šè¯ä¸ Pod è¿›è¡Œç½‘ç»œé€šä¿¡ã€‚</p>
<blockquote>
<p><strong>å®¹å™¨è¿è¡Œæ—¶ï¼ˆContainer Runtimeï¼‰</strong></p>
</blockquote>
<p>å®¹å™¨è¿è¡Œæ—¶è´Ÿè´£åˆ›å»ºå®¹å™¨è¿è¡Œç¯å¢ƒã€‚</p>
<p>Kubernetes æ”¯æŒå¤šä¸ªå®¹å™¨è¿è¡Œæ—¶: Dockerï¼ˆå³å°†è¢«åºŸå¼ƒï¼‰ã€containerdã€CRI-Oä»¥åŠä»»ä½•å®ç° <a href="https://link.juejin.cn/?target=https://github.com/kubernetes/community/blob/master/contributors/devel/sig-node/container-runtime-interface.md">Kubernetes CRI (å®¹å™¨è¿è¡Œç¯å¢ƒæ¥å£)</a>çš„runtimeã€‚</p>
<h3 id="K8såŸºæœ¬å·¥ä½œæµç¨‹"><a href="#K8såŸºæœ¬å·¥ä½œæµç¨‹" class="headerlink" title="K8såŸºæœ¬å·¥ä½œæµç¨‹"></a>K8såŸºæœ¬å·¥ä½œæµç¨‹</h3><ol>
<li><p>kubectl å®¢æˆ·ç«¯é¦–å…ˆå°†CLIå‘½ä»¤è½¬åŒ–ä¸ºRESTfulçš„APIè°ƒç”¨ï¼Œç„¶åå‘é€åˆ°kube-apiserverã€‚</p>
</li>
<li><p>kube-apiserver åœ¨éªŒè¯è¿™äº› API è°ƒç”¨åï¼Œå°†ä»»åŠ¡å…ƒä¿¡æ¯å¹¶å­˜å‚¨åˆ°etcdï¼Œæ¥ç€è°ƒç”¨ kube-scheduler å¼€å§‹å†³ç­–ä¸€ä¸ªç”¨äºä½œä¸šçš„NodeèŠ‚ç‚¹ã€‚</p>
</li>
<li><p>ä¸€æ—¦ kube-scheduler è¿”å›ä¸€ä¸ªé€‚åˆè°ƒåº¦çš„ç›®æ ‡èŠ‚ç‚¹åï¼Œkube-apiserver å°±æŠŠä»»åŠ¡çš„èŠ‚ç‚¹ä¿¡æ¯å­˜å…¥etcdï¼Œå¹¶åˆ›å»ºä»»åŠ¡ã€‚</p>
</li>
<li><p>æ­¤æ—¶ç›®æ ‡èŠ‚ç‚¹ä¸­çš„ kubeletæ­£ç›‘å¬apiserverï¼Œå½“ç›‘å¬åˆ°æœ‰æ–°ä»»åŠ¡éœ€è¦è°ƒåº¦åˆ°æœ¬èŠ‚ç‚¹åï¼Œkubeleté€šè¿‡æœ¬åœ°runtimeåˆ›å»ºä»»åŠ¡å®¹å™¨ï¼Œæ‰§è¡Œä½œä¸šã€‚</p>
</li>
<li><p>æ¥ç€kubeletå°†ä»»åŠ¡çŠ¶æ€ç­‰ä¿¡æ¯è¿”å›ç»™apiserverå­˜å‚¨åˆ°etcdã€‚</p>
</li>
<li><p>è¿™æ ·æˆ‘ä»¬çš„ä»»åŠ¡å·²ç»åœ¨è¿è¡Œäº†ï¼Œæ­¤æ—¶control-managerå‘æŒ¥ä½œç”¨ä¿è¯ä»»åŠ¡ä¸€ç›´æ˜¯æˆ‘ä»¬æœŸæœ›çš„çŠ¶æ€</p>
</li>
</ol>
<h2 id="K8séƒ¨ç½²"><a href="#K8séƒ¨ç½²" class="headerlink" title="K8séƒ¨ç½²"></a>K8séƒ¨ç½²</h2><h3 id="Masteréƒ¨ç½²"><a href="#Masteréƒ¨ç½²" class="headerlink" title="Masteréƒ¨ç½²"></a>Masteréƒ¨ç½²</h3><blockquote>
<p><strong>etcdéƒ¨ç½²</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">[root@master ~]$ yum install etcd -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">[root@master ~]$ rpm -ql etcd</span><br><span class="line">/etc/etcd</span><br><span class="line">/etc/etcd/etcd.conf</span><br><span class="line">/usr/bin/etcd</span><br><span class="line">/usr/bin/etcdctl</span><br><span class="line">/usr/lib/systemd/system/etcd.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æ˜¯ä¿®æ”¹etcdçš„å®¢æˆ·ç«¯ç›‘å¬åœ°å€ï¼Œä»¥ä¾¿ä¹‹åå®‰è£…çš„ç½‘ç»œæ’ä»¶flannelç»„ä»¶å¯ä»¥è®¿é—®</span></span><br><span class="line">[root@master etcd]$ vim etcd.conf</span><br><span class="line"></span><br><span class="line">ETCD_LISTEN_CLIENT_URLS=<span class="string">&quot;http://0.0.0.0:2379&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@master ~]$ systemctl <span class="built_in">enable</span> etcd</span><br><span class="line">[root@master ~]$ systemctl start etcd</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">etcdctl --<span class="built_in">help</span>		<span class="comment"># etcdctlæ˜¯etcdæ•°æ®åº“çš„å‘½ä»¤è¡Œå·¥å…·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šetcdæ˜¯ä¸€ä¸ªkey/valueå‹çš„æ•°æ®åº“ï¼Œé‡Œé¢çš„keyè¢«æŠ½è±¡ä¸ºä¸¤ç§å½¢å¼ï¼šæ–‡ä»¶å’Œç›®å½•</span></span><br><span class="line"></span><br><span class="line">	 backup          å¤‡ä»½ä¸€ä¸ªetcdæ•°æ®åº“</span><br><span class="line">     cluster-health  æ£€æŸ¥æ•°æ®åº“çš„å¥åº·çŠ¶å†µ</span><br><span class="line">     mk              åˆ›å»ºä¸€ä¸ªæ–°çš„é”®å€¼å¯¹ï¼šetcdctl mk &lt;key&gt; &lt;value&gt;</span><br><span class="line">     <span class="built_in">mkdir</span>           åˆ›å»ºä¸€ä¸ªæ–°çš„ç›®å½•ï¼šetcdctl <span class="built_in">mkdir</span> &lt;key&gt;</span><br><span class="line">     <span class="built_in">rm</span>              ç§»é™¤ä¸€ä¸ªé”®å€¼å¯¹æˆ–ç›®å½•ï¼š etcdctl <span class="built_in">rm</span> &lt;key&gt;</span><br><span class="line">     <span class="built_in">rmdir</span>           ç§»é™¤ä¸€ä¸ªç©ºç›®å½•æˆ–è€…é”®å€¼å¯¹ï¼šetcdctl <span class="built_in">rmdir</span> &lt;key&gt;</span><br><span class="line">     get             æ ¹æ®é”®åæ£€ç´¢é”®å€¼ï¼šetcdctl get &lt;key&gt;</span><br><span class="line">     <span class="built_in">ls</span>              æ£€ç´¢ç›®å½•</span><br><span class="line">     <span class="built_in">set</span>             ç»™é”®åè®¾ç½®ä¸€ä¸ªé”®å€¼ï¼šetcdctl <span class="built_in">set</span> &lt;key&gt; &lt;value&gt;</span><br><span class="line">     update          æ›´æ–°ä¸€ä¸ªå·²å­˜åœ¨çš„é”®åçš„é”®å€¼ï¼šetcdctl update &lt;key&gt; &lt;value&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>masteréƒ¨ç½²</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…kubernetes-masterï¼Œä¼šé™„å¸¦kubernetes-client(å³kube-ctl)</span></span><br><span class="line">[root@master kubernetes]$ yum install -y kubernetes-master</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶ï¼Œå‘ç°åŒ…å«äº†apiserverã€controller-managerã€schedulerä¸‰éƒ¨åˆ†</span></span><br><span class="line">[root@master kubernetes]$ rpm -ql kubernetes-master </span><br><span class="line">/etc/kubernetes</span><br><span class="line">/etc/kubernetes/apiserver</span><br><span class="line">/etc/kubernetes/config</span><br><span class="line">/etc/kubernetes/controller-manager</span><br><span class="line">/etc/kubernetes/scheduler</span><br><span class="line">/run/kubernetes</span><br><span class="line">/usr/bin/hyperkube</span><br><span class="line">/usr/bin/kube-apiserver</span><br><span class="line">/usr/bin/kube-controller-manager</span><br><span class="line">/usr/bin/kube-scheduler</span><br><span class="line">/usr/lib/systemd/system/kube-apiserver.service</span><br><span class="line">/usr/lib/systemd/system/kube-controller-manager.service</span><br><span class="line">/usr/lib/systemd/system/kube-scheduler.service</span><br><span class="line">/usr/lib/tmpfiles.d/kubernetes.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘apiseverçš„é…ç½®æ–‡ä»¶ï¼Œä¸»è¦ä¿®æ”¹ä»¥ä¸‹å†…å®¹</span></span><br><span class="line">[root@master kubernetes]$ vim apiserver </span><br><span class="line"></span><br><span class="line"><span class="comment"># apiserverç›‘å¬çš„åœ°å€</span></span><br><span class="line">KUBE_API_ADDRESS=<span class="string">&quot;--insecure-bind-address=0.0.0.0&quot;</span></span><br><span class="line"><span class="comment"># æœ¬åœ°apiserverçš„ç›‘å¬ç«¯å£ï¼Œé»˜è®¤å€¼æ— éœ€æ”¹åŠ¨</span></span><br><span class="line"><span class="comment"># KUBE_API_PORT=&quot;--port=8080&quot;</span></span><br><span class="line"><span class="comment"># etcdé›†ç¾¤çš„åœ°å€</span></span><br><span class="line">KUBE_ETCD_SERVERS=<span class="string">&quot;--etcd-servers=http://127.0.0.1:2379&quot;</span></span><br><span class="line"><span class="comment"># é›†ç¾¤æœåŠ¡èµ„æºçš„åœ°å€èŒƒå›´</span></span><br><span class="line">KUBE_SERVICE_ADDRESSES=<span class="string">&quot;--service-cluster-ip-range=10.254.0.0/16&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘masterçš„é…ç½®æ–‡ä»¶ï¼Œä¸»è¦ä¿®æ”¹ä»¥ä¸‹å†…å®¹</span></span><br><span class="line">[root@master kubernetes]$ vim config </span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†é”™è¯¯ä½¿å‡ºè¿½åŠ åˆ°ç³»ç»Ÿæ—¥å¿—</span></span><br><span class="line">KUBE_LOGTOSTDERR=<span class="string">&quot;--logtostderr=true&quot;</span></span><br><span class="line"><span class="comment"># æ—¥å¿—çº§åˆ«ï¼Œ0ä»£è¡¨debugçº§åˆ«</span></span><br><span class="line">KUBE_LOG_LEVEL=<span class="string">&quot;--v=0&quot;</span></span><br><span class="line"><span class="comment"># æ˜¯å¦å…è®¸é›†ç¾¤å®¹å™¨ä»¥ç‰¹æƒæ¨¡å¼è¿è¡Œ</span></span><br><span class="line">KUBE_ALLOW_PRIV=<span class="string">&quot;--allow-privileged=false&quot;</span></span><br><span class="line"><span class="comment"># æœ¬åœ°çš„masterç»„ä»¶æ€ä¹ˆå‘ç°apiserverï¼Œæ­¤å¤„æ˜¯apiseverçš„åœ°å€</span></span><br><span class="line">KUBE_MASTER=<span class="string">&quot;--master=http://127.0.0.1:8080&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨</span></span><br><span class="line">[root@master kubernetes]$ systemctl <span class="built_in">enable</span> kube-apiserver kube-controller-manager kube-scheduler</span><br><span class="line">[root@master kubernetes]$ systemctl start kube-apiserver kube-controller-manager kube-scheduler</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¥åº·çŠ¶æ€ï¼Œcsçš„æ„æ€æ˜¯componentstatusesï¼Œç»„ä»¶çŠ¶æ€ï¼Œæœ‰è¿”å›è¯´æ˜apiseverç»„ä»¶çš„çŠ¶æ€ä¹Ÿæ˜¯å¥åº·çš„</span></span><br><span class="line">[root@master kubernetes]$ kubectl get cs</span><br><span class="line">NAME                 STATUS    MESSAGE             ERROR</span><br><span class="line">etcd-0               Healthy   &#123;<span class="string">&quot;health&quot;</span>:<span class="string">&quot;true&quot;</span>&#125;   </span><br><span class="line">scheduler            Healthy   ok                  </span><br><span class="line">controller-manager   Healthy   ok  </span><br></pre></td></tr></table></figure>

<h3 id="Nodeéƒ¨ç½²"><a href="#Nodeéƒ¨ç½²" class="headerlink" title="Nodeéƒ¨ç½²"></a>Nodeéƒ¨ç½²</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…kubernetes-nodeï¼Œä¼šé™„å¸¦kubernetes-client(å³kube-ctl)</span></span><br><span class="line">[root@node1 ~]$ yum install kubernetes-node -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è½¯ä»¶åŒ…ï¼Œåˆ†ä¸ºkubenetã€proxyä¸¤éƒ¨åˆ†</span></span><br><span class="line">[root@node1 ~]$ rpm -ql kubernetes-node </span><br><span class="line">/etc/kubernetes</span><br><span class="line">/etc/kubernetes/config</span><br><span class="line">/etc/kubernetes/kubelet</span><br><span class="line">/etc/kubernetes/proxy</span><br><span class="line">/etc/systemd/system.conf.d/kubernetes-accounting.conf</span><br><span class="line">/run/kubernetes</span><br><span class="line">/usr/bin/hyperkube</span><br><span class="line">/usr/bin/kube-proxy</span><br><span class="line">/usr/bin/kubelet</span><br><span class="line">/usr/lib/systemd/system/kube-proxy.service</span><br><span class="line">/usr/lib/systemd/system/kubelet.service</span><br><span class="line">/usr/lib/tmpfiles.d/kubernetes.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘nodeçš„é…ç½®æ–‡ä»¶ï¼Œä¸»è¦ä¿®æ”¹apiserverçš„åœ°å€</span></span><br><span class="line">[root@node1 kubernetes]$ vim config </span><br><span class="line"></span><br><span class="line"><span class="comment"># apiserverçš„åœ°å€</span></span><br><span class="line">KUBE_MASTER=<span class="string">&quot;--master=http://192.168.110.160:8080&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘kubeletçš„é…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@node1 kubernetes]$ vim kubelet </span><br><span class="line"></span><br><span class="line"><span class="comment"># kubeletçš„åœ°å€ï¼Œæ­¤å¤„æ˜¯æœ¬åœ°</span></span><br><span class="line">KUBELET_ADDRESS=<span class="string">&quot;--address=127.0.0.1&quot;</span></span><br><span class="line"><span class="comment"># kubeletçš„ç«¯å£ï¼Œé»˜è®¤æ— éœ€ä¿®æ”¹</span></span><br><span class="line"><span class="comment"># KUBELET_PORT=&quot;--port=10250&quot;</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨IPåœ°å€è¦†ç›–ä¸»æœºåï¼Œä¹Ÿå¯ä»¥ç•™ç©ºï¼Œä½¿ç”¨çœŸå®ä¸»æœºå</span></span><br><span class="line">KUBELET_HOSTNAME=<span class="string">&quot;--hostname-override=192.168.110.161&quot;</span></span><br><span class="line"><span class="comment"># apiserverçš„åœ°å€</span></span><br><span class="line">KUBELET_API_SERVER=<span class="string">&quot;--api-servers=http://192.168.110.160:8080&quot;</span></span><br><span class="line"><span class="comment"># pod infrastructure container</span></span><br><span class="line">KUBELET_POD_INFRA_CONTAINER=<span class="string">&quot;--pod-infra-container-image=registry.access.redhat.com/rhel7/pod-infrastructure:latest&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨</span></span><br><span class="line">[root@node1 kubernetes]$ systemctl <span class="built_in">enable</span> kubelet kube-proxy</span><br><span class="line">[root@node1 kubernetes]$ systemctl start kubelet kube-proxy</span><br><span class="line"></span><br><span class="line"><span class="comment"># masterèŠ‚ç‚¹å¯ä»¥æŸ¥çœ‹nodeèŠ‚ç‚¹ä¿¡æ¯</span></span><br><span class="line">[root@master kubernetes]$ kubectl get node</span><br><span class="line">NAME              STATUS    AGE</span><br><span class="line">192.168.110.161   Ready     14m</span><br><span class="line">192.168.110.162   Ready     2m</span><br><span class="line">192.168.110.163   Ready     1m</span><br><span class="line">192.168.110.164   Ready     49s</span><br></pre></td></tr></table></figure>

<p>è¡¥å……ï¼šä¸Šé¢è¯´åˆ°kubeletå¯ä»¥ç›‘æ§å®¹å™¨çš„å¥åº·çŠ¶æ€ï¼Œè¿™æ˜¯å› ä¸ºkubeletä¸­å†…ç½®äº†cadvisorï¼Œæµè§ˆå™¨è®¿é—®<code>http://nodeèŠ‚ç‚¹IP:4194</code>å¯ä»¥æŸ¥çœ‹</p>
<h3 id="ç½‘ç»œæ’ä»¶éƒ¨ç½²"><a href="#ç½‘ç»œæ’ä»¶éƒ¨ç½²" class="headerlink" title="ç½‘ç»œæ’ä»¶éƒ¨ç½²"></a>ç½‘ç»œæ’ä»¶éƒ¨ç½²</h3><p>ç½‘ç»œæ’ä»¶ä½¿ç”¨çš„æ˜¯flannelï¼Œæ‰€æœ‰èŠ‚ç‚¹éƒ½éœ€è¦å®‰è£…å¹¶å¯åŠ¨</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…</span></span><br><span class="line">[root@node1 kubernetes]$ yum install -y flannel</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶</span></span><br><span class="line">[root@node1 kubernetes]$ rpm -ql flannel</span><br><span class="line">/etc/sysconfig/flanneld</span><br><span class="line">/run/flannel</span><br><span class="line">/usr/bin/flanneld</span><br><span class="line">/usr/bin/flanneld-start</span><br><span class="line">/usr/lib/systemd/system/docker.service.d/flannel.conf</span><br><span class="line">/usr/lib/systemd/system/flanneld.service</span><br><span class="line">/usr/lib/tmpfiles.d/flannel.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œä¸»è¦æ˜¯ä¸¤è¡Œå†…å®¹</span></span><br><span class="line">[root@node1 sysconfig]$ vim flanneld </span><br><span class="line"></span><br><span class="line"><span class="comment"># etcd æ•°æ®åº“çš„åœ°å€</span></span><br><span class="line">FLANNEL_ETCD_ENDPOINTS=<span class="string">&quot;http://192.168.110.160:2379&quot;</span></span><br><span class="line"><span class="comment"># etcdæ•°æ®åº“ä¸­è¦å­˜å‚¨ç½‘ç»œç›¸å…³çš„é…ç½®ï¼Œæ‰€ä»¥è¦åˆ›å»ºé”®å€¼å¯¹ï¼Œæ­¤å¤„æ˜¯æŒ‡å®šé”®å€¼å¯¹çš„é”®åçš„å‰ç¼€</span></span><br><span class="line">FLANNEL_ETCD_PREFIX=<span class="string">&quot;/atomic.io/network&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨masterèŠ‚ç‚¹åˆ›å»ºetcdçš„é”®å€¼å¯¹ï¼Œé…ç½®ç½‘ç»œ</span></span><br><span class="line">etcdctl mk /atomic.io/network/config <span class="string">&#x27;&#123;&quot;Network&quot;:&quot;172.18.0.0/16&quot;,&quot;Backend&quot;:&#123;&quot;Type&quot;:&quot;vxlan&quot;&#125;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ï¼Œæ³¨æ„ï¼šå·¥ä½œèŠ‚ç‚¹éœ€è¦é‡å¯dockeræ‰èƒ½æ›´æ–°ç½‘ç»œé…ç½®</span></span><br><span class="line">[root@master etcd]$ systemctl <span class="built_in">enable</span> flanneld.service </span><br><span class="line">[root@master etcd]$ systemctl start flanneld.service </span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼šéƒ¨ç½²ç½‘ç»œæ’ä»¶ä¹‹åï¼Œåœ¨ä¸åŒèŠ‚ç‚¹è¿è¡Œå®¹å™¨å¯èƒ½æ— æ³•äº’ç›¸pingé€šï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºé»˜è®¤çš„è½¬å‘ç­–ç•¥æ˜¯DROPï¼Œéœ€è¦ä¿®æ”¹ä¸ºACCEPTï¼Œè§£å†³æ–¹æ³•ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1 ä¿®æ”¹å®¿ä¸»æœºçš„è½¬å‘è§„åˆ™</span></span><br><span class="line">iptables -P FORWARD ACCEPT</span><br><span class="line">iptables-save &gt; /etc/sysconfig/iptables</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2 ä¿®æ”¹dockerçš„å¯åŠ¨è„šæœ¬ï¼Œåœ¨[Service]åŒºåŸŸå†…å¢åŠ ä¸€è¡Œï¼Œåœ¨å¯åŠ¨å‰æ‰§è¡Œä¸€æ¡iptableså‘½ä»¤ï¼Œä¿®æ”¹è½¬å‘è§„åˆ™</span></span><br><span class="line">vim /usr/lib/systemd/system/docker.service</span><br><span class="line">ExecStartPost=/usr/sbin/iptables -P FORWARD ACCEPT</span><br><span class="line">systemctl daemon-reload &amp;&amp; systemctl restart docker</span><br></pre></td></tr></table></figure>

</div><script src="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery) {
        var options1 = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1);
        }</script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2024-03-26</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« é‚“èƒ–èƒ–</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/K8S/'>
                            K8S
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>
                            å­¦ä¹ ç¬”è®°
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    <!-- <div class="post-footer-pre-next">
        <span>ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
        <span class="post-footer-pre-next-last-span-right">ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
    </div> -->

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
             

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery.min.js"></script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>