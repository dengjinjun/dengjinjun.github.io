<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="Podè¯¦è§£" />
    <meta name="hexo-theme-A4" content="v1.9.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Dengpangpang</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Dengpangpang</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">ğŸŸé¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">ğŸ“æ–‡ç« </a></li>
            
        
            
                <li><a href="/tags/">ğŸ·ï¸æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">ğŸ—‚ï¸åˆ†ç±»</a></li>
            
        
            
                <li><a href="/about/">ğŸ‘ï¸å…³äº</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            Podè¯¦è§£
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#pod%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="post-toc-text">podåŸºæœ¬æ“ä½œ</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pod%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="post-toc-text">podç›¸å…³å‘½ä»¤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%88%9B%E5%BB%BApod%E6%B5%81%E7%A8%8B"><span class="post-toc-text">åˆ›å»ºpodæµç¨‹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pod%E6%A8%A1%E6%9D%BF%E8%A1%8C%E4%B8%BA"><span class="post-toc-text">podæ¨¡æ¿è¡Œä¸º</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%AF%E8%83%BD%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="post-toc-text">å¯èƒ½é‡åˆ°çš„é—®é¢˜</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pod%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="post-toc-text">podç”Ÿå‘½å‘¨æœŸ</span></a></li></ol></li></ol>
            
        
        <link rel="stylesheet" type="text/css" href="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/css/lightgallery.min.css" /><div class=".article-gallery"><p>Podæ˜¯Kubernetesä¸­èƒ½å¤Ÿåˆ›å»ºå’Œéƒ¨ç½²çš„æœ€å°å•å…ƒï¼Œæ˜¯Kubernetesé›†ç¾¤ä¸­çš„ä¸€ä¸ªåº”ç”¨å®ä¾‹ã€‚</p>
<p>Podå¯ä»¥åŒ…å«äº†ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ï¼Œè¿˜åŒ…æ‹¬äº†å­˜å‚¨ã€ç½‘ç»œç­‰å„ä¸ªå®¹å™¨å…±äº«çš„èµ„æºã€‚Podæ”¯æŒå¤šç§å®¹å™¨ç¯å¢ƒï¼ŒDockeråˆ™æ˜¯æœ€æµè¡Œçš„å®¹å™¨ç¯å¢ƒã€‚</p>
<h2 id="podåŸºæœ¬æ“ä½œ"><a href="#podåŸºæœ¬æ“ä½œ" class="headerlink" title="podåŸºæœ¬æ“ä½œ"></a>podåŸºæœ¬æ“ä½œ</h2><h3 id="podç›¸å…³å‘½ä»¤"><a href="#podç›¸å…³å‘½ä»¤" class="headerlink" title="podç›¸å…³å‘½ä»¤"></a>podç›¸å…³å‘½ä»¤</h3><blockquote>
<p><strong>åˆ›å»ºpod</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl create -f podæ¨¡æ¿æ–‡ä»¶		<span class="comment"># é€šè¿‡yamlæ–‡ä»¶åˆ›å»ºpodï¼Œä¸æ”¯æŒé‡å¤åˆ›å»º</span></span><br><span class="line">kubectl apply -f podæ¨¡æ¿æ–‡ä»¶		<span class="comment"># åŒæ ·é€šè¿‡yamlæ–‡ä»¶åˆ›å»ºpodï¼Œæ”¯æŒé‡å¤æ‰§è¡Œï¼Œé€‚åˆç”¨äºæ›´æ–°èµ„æº</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>æŸ¥çœ‹pod</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pod		<span class="comment"># æŸ¥çœ‹podçš„ç®€çŸ­ä¿¡æ¯</span></span><br><span class="line">kubectl get pod -o wide		<span class="comment"># æŸ¥çœ‹IPç›¸å…³ä¿¡æ¯</span></span><br><span class="line">kubectl get pod -o podæ¨¡æ¿æ–‡ä»¶		<span class="comment"># æŸ¥çœ‹podçš„yamlæ–‡ä»¶</span></span><br><span class="line">kubectl get pod --show-labels		<span class="comment"># æŸ¥çœ‹podçš„æ ‡ç­¾</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>åˆ é™¤pod</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete pod podåç§°		<span class="comment"># åŸºäºpodåç§°çš„æ–¹å¼åˆ é™¤pod</span></span><br><span class="line">kubectl delete -f podæ¨¡æ¿æ–‡ä»¶		<span class="comment"># é€šè¿‡yamlæ–‡ä»¶åˆ é™¤pod</span></span><br><span class="line">kubectl delete -f .		<span class="comment"># åˆ é™¤å½“å‰ç›®å½•ä¸‹æ‰€æœ‰yamlæ–‡ä»¶åˆ›å»ºçš„pod</span></span><br></pre></td></tr></table></figure>

<h3 id="åˆ›å»ºpodæµç¨‹"><a href="#åˆ›å»ºpodæµç¨‹" class="headerlink" title="åˆ›å»ºpodæµç¨‹"></a>åˆ›å»ºpodæµç¨‹</h3><blockquote>
<p><strong>åˆ›å»ºå•å®¹å™¨Pod</strong></p>
</blockquote>
<p>å•å®¹å™¨Podæ˜¯æœ€å¸¸è§çš„éƒ¨ç½²æ–¹å¼</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆç¼–è¾‘ä¸€ä¸ªpodæ¨¡æ¿</span></span><br><span class="line">[root@master kubernetes]$ vim /pod/nginx.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># èµ„æºçš„ç±»å‹</span></span><br><span class="line">kind: Pod</span><br><span class="line"><span class="comment"># APIçš„ç‰ˆæœ¬å·</span></span><br><span class="line">apiVersion: v1</span><br><span class="line"><span class="comment"># å…ƒæ•°æ®ä¿¡æ¯</span></span><br><span class="line">metadata:</span><br><span class="line">  <span class="comment"># èµ„æºçš„åç§°</span></span><br><span class="line">  name: nginx</span><br><span class="line">  <span class="comment"># è‡ªå®šä¹‰èµ„æºçš„æ ‡ç­¾,å…¶ä¸­çš„KVç”±ä½ è‡ªå®šä¹‰å³å¯.</span></span><br><span class="line">  labels:</span><br><span class="line">    disk: ssd</span><br><span class="line"><span class="comment"># Podçš„å®šä¹‰,ä¸»è¦æè¿°è¿™ä¸ªPodè¿è¡Œä»€ä¹ˆæœåŠ¡</span></span><br><span class="line">spec:</span><br><span class="line">  <span class="comment"># æŒ‡å®šå®¹å™¨ç›¸å…³çš„é…ç½®</span></span><br><span class="line">  containers:</span><br><span class="line">    - name: nginx01  <span class="comment"># å®¹å™¨çš„åå­—</span></span><br><span class="line">      image: registry:80/nginx:v1  <span class="comment"># æŒ‡å®šå®¹å™¨çš„é•œåƒåœ°å€</span></span><br><span class="line">      ports:  <span class="comment"># æŒ‡å®šå®¹å™¨çš„æš´éœ²ç«¯å£</span></span><br><span class="line">        - containerPort: 80  <span class="comment"># æš´éœ²å®¹å™¨çš„80ç«¯å£</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># ç„¶ååˆ›å»ºè¿™ä¸ªpodå³å¯</span></span><br><span class="line">[root@master kubernetes]$ kubectl create -f /pod/nginx.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®¹å™¨çŠ¶æ€</span></span><br><span class="line">[root@master kubernetes]$ kubectl get pod</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">[root@master kubernetes]$ kubectl describe pod nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿æ¥</span></span><br><span class="line">[root@master kubernetes]$ kubectl <span class="built_in">exec</span> -n å‘½åç©ºé—´åç§° -it podåç§° -c å®¹å™¨åç§° -- <span class="built_in">command</span> </span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>åˆ›å»ºå¤šå®¹å™¨pod</strong></p>
</blockquote>
<p>å¤šå®¹å™¨Podæ˜¯ç›¸å¯¹é«˜é˜¶çš„ä½¿ç”¨æ–¹å¼ï¼Œä¸€ä¸ªPodå†…çš„å®¹å™¨å…±äº«IPåœ°å€å’Œç«¯å£èŒƒå›´ï¼Œå®¹å™¨ä¹‹é—´å¯ä»¥é€šè¿‡ localhost äº’ç›¸è®¿é—®ã€‚é™¤éåº”ç”¨è€¦åˆç‰¹åˆ«ä¸¥é‡ï¼Œä¸€èˆ¬ä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ­¤å¤„ä»…ç»™å‡ºpodæ¨¡æ¿ï¼Œå…¶ä»–æ“ä½œä¸åˆ›å»ºå•å®¹å™¨podç›¸åŒ</span></span><br><span class="line">[root@master kubernetes]$ vim /pod/nginx.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># èµ„æºçš„ç±»å‹</span></span><br><span class="line">kind: Pod</span><br><span class="line"><span class="comment"># APIçš„ç‰ˆæœ¬å·</span></span><br><span class="line">apiVersion: v1</span><br><span class="line"><span class="comment"># å…ƒæ•°æ®ä¿¡æ¯</span></span><br><span class="line">metadata:</span><br><span class="line">  <span class="comment"># èµ„æºçš„åç§°</span></span><br><span class="line">  name: nginx</span><br><span class="line">  <span class="comment"># è‡ªå®šä¹‰èµ„æºçš„æ ‡ç­¾,å…¶ä¸­çš„KVç”±ä½ è‡ªå®šä¹‰å³å¯.</span></span><br><span class="line">  labels:</span><br><span class="line">    disk: ssd</span><br><span class="line"><span class="comment"># Podçš„å®šä¹‰,ä¸»è¦æè¿°è¿™ä¸ªPodè¿è¡Œä»€ä¹ˆæœåŠ¡</span></span><br><span class="line">spec:</span><br><span class="line">  <span class="comment"># æŒ‡å®šå®¹å™¨ç›¸å…³çš„é…ç½®</span></span><br><span class="line">  containers:</span><br><span class="line">    - name: alpine01</span><br><span class="line">      image: registry:80/alpine:v1</span><br><span class="line">      <span class="built_in">command</span>: [<span class="string">&quot;sleep&quot;</span>,<span class="string">&quot;9999&quot;</span>]</span><br><span class="line">    - name: nginx01  <span class="comment"># å®¹å™¨çš„åå­—</span></span><br><span class="line">      image: registry:80/nginx:v1  <span class="comment"># æŒ‡å®šå®¹å™¨çš„é•œåƒåœ°å€</span></span><br><span class="line">      ports:  <span class="comment"># æŒ‡å®šå®¹å™¨çš„æš´éœ²ç«¯å£</span></span><br><span class="line">        - containerPort: 80  <span class="comment"># æš´éœ²å®¹å™¨çš„80ç«¯å£</span></span><br></pre></td></tr></table></figure>

<h3 id="podæ¨¡æ¿è¡Œä¸º"><a href="#podæ¨¡æ¿è¡Œä¸º" class="headerlink" title="podæ¨¡æ¿è¡Œä¸º"></a>podæ¨¡æ¿è¡Œä¸º</h3><blockquote>
<p><strong>æŒ‡å®šnamespace</strong></p>
</blockquote>
<p>å‘½åç©ºé—´æ˜¯å®ç°ç¯å¢ƒéš”ç¦»çš„</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å‘½åç©ºé—´ï¼Œnsæ˜¯namespaceçš„ç®€å†™</span></span><br><span class="line">kubectl get ns		<span class="comment"># é€šè¿‡kubectlå‘½ä»¤æŸ¥çœ‹</span></span><br><span class="line">etcdctl <span class="built_in">ls</span> /registry/namespaces		<span class="comment"># åœ¨etcdæ•°æ®åº“ä¸­æŸ¥çœ‹</span></span><br><span class="line">kubectl describe ns</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªå‘½åç©ºé—´</span></span><br><span class="line">kubectl create ns å‘½åç©ºé—´åç§°		<span class="comment"># ç›´æ¥åˆ›å»º</span></span><br><span class="line">kubectl create -f yamlæ–‡ä»¶		<span class="comment"># è¿˜æœ‰ä¸€ç§åˆ›å»ºå‘½åç©ºé—´çš„æ–¹å¼ï¼Œæ˜¯é€šè¿‡æ–‡ä»¶å»åˆ›å»ºï¼Œç±»ä¼¼äºé€šè¿‡æ–‡ä»¶åˆ›å»ºpodçš„æ–¹å¼ï¼Œå¯ä»¥è‡ªè¡Œäº†è§£</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ä¸€ä¸ªå‘½åç©ºé—´</span></span><br><span class="line">kubectl delete ns å‘½åç©ºé—´åç§°</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨å‘½åç©ºé—´</span></span><br><span class="line">namespace: &lt;string&gt;		<span class="comment"># åœ¨podæ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œmetadataä¸‹çº§æŒ‡å®š`namespace: å‘½åç©ºé—´åç§°`</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>æŒ‡å®šnode</strong></p>
</blockquote>
<p>æŒ‡å®šå°†è¯¥podè°ƒåº¦åœ¨æŸä¸ªèŠ‚ç‚¹è¿è¡Œ</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nodeName: &lt;string&gt;			<span class="comment"># åœ¨podæ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œmetadataä¸‹çº§æŒ‡å®š`nodeName:èŠ‚ç‚¹åç§°`</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>èµ„æºé™åˆ¶</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">reousrces: &lt;object&gt;		<span class="comment"># åœ¨podæ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œcontainersä¸‹çº§æŒ‡å®š`resources:èµ„æºå¯¹è±¡`</span></span><br><span class="line">resourcesä¸‹çº§å¯ä»¥æŒ‡å®šlimitså¯¹è±¡å’Œrequestså¯¹è±¡ï¼Œå‰è€…è¡¨ç¤ºæœ€å¤§èµ„æºé™åˆ¶ï¼Œåè€…è¡¨ç¤ºæœ€å°‘èµ„æºéœ€æ±‚</span><br><span class="line">resources:</span><br><span class="line">  limits:</span><br><span class="line">    cpu: 500m		<span class="comment"># cpuèµ„æºæ¢ç®—æ˜¯1core=1000m</span></span><br><span class="line">    memory: 500M</span><br><span class="line">  requests:</span><br><span class="line">    cpu: 100m</span><br><span class="line">    memory: 100M</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>æŒ‡å®šæš´éœ²çš„ç«¯å£</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ports: &lt;[]Object&gt;		<span class="comment"># åœ¨podæ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œcontainersä¸‹çº§æŒ‡å®š`ports:èµ„æºå¯¹è±¡åˆ—è¡¨`</span></span><br><span class="line">portsä¸‹çº§å¯ä»¥æŒ‡å®šäº”ä¸ªå¯¹è±¡ï¼Œç¤ºä¾‹ï¼š</span><br><span class="line">ports:</span><br><span class="line">  - containerPort: 80		<span class="comment"># å®¹å™¨æš´éœ²çš„ç«¯å£</span></span><br><span class="line">    protocol: TCP		<span class="comment"># åè®®ï¼Œé»˜è®¤æ˜¯TCPï¼Œå¯é€‰ï¼šTCPæˆ–è€…UDP</span></span><br><span class="line">    name: nginx-01		<span class="comment"># ç«¯å£åï¼Œå¯ä»¥ç»™è¿™ä¸ªå¼€æ”¾çš„ç«¯å£å‘½åï¼Œåç»­å¯ä»¥å¼•ç”¨</span></span><br><span class="line">    hostPort: 8888		<span class="comment"># å®¹å™¨çš„ç«¯å£ç»‘å®šåˆ°ä¸»æœºçš„ç«¯å£ï¼Œå¦‚æœæŒ‡å®šäº†ä½¿ç”¨ä¸»æœºç½‘ç»œï¼Œé‚£ä¹ˆè¦è·Ÿå®¹å™¨ç«¯å£ç›¸åŒ</span></span><br><span class="line">    hostIP: 0.0.0.0		<span class="comment"># ç»‘å®šåˆ°ä¸»æœºçš„å“ªä¸ªIPåœ°å€</span></span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>ä½¿ç”¨ä¸»æœºç½‘ç»œ</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ä¸»æœºç½‘ç»œç±»ä¼¼äºdockerä¸­çš„hostç½‘ç»œç±»å‹ï¼Œpodè·Ÿå®¿ä¸»æœºå…±äº«IPå’Œç«¯å£</span></span><br><span class="line">hostNetwork: &lt;boolean&gt;		<span class="comment"># åœ¨podæ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œspecä¸‹çº§æŒ‡å®š`hostNetwork: true`å³å¯è®©podä½¿ç”¨ä¸»æœºç½‘ç»œï¼Œé»˜è®¤æ˜¯false</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>æŒ‡å®šä¸»æœºå</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname: &lt;string&gt;		<span class="comment"># åœ¨podæ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œspecä¸‹çº§æŒ‡å®š`hostname: è‡ªå®šä¹‰ä¸»æœºå`å³å¯æŒ‡å®šä¸»æœºå,å¦‚æœä¸æŒ‡å®šåˆ™æ˜¯podåç§°</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>é‡å¯ç­–ç•¥</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># podå†…æ‰€æœ‰å®¹å™¨çš„é‡å¯ç­–ç•¥ï¼Œå¯é€‰Always, OnFailure, Never</span></span><br><span class="line">restartPolicy: &lt;string&gt;		<span class="comment"># åœ¨podæ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œspecä¸‹çº§æŒ‡å®š`restartPolicy: é‡å¯ç­–ç•¥`ï¼Œå¦‚æœä¸æŒ‡å®šé»˜è®¤æ˜¯always</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>é•œåƒæ‹‰å–ç­–ç•¥</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»ºå®¹å™¨æ—¶çš„é•œåƒæ‹‰å–ç­–ç•¥ï¼Œå¯é€‰Always, Never, IfNotPresent</span></span><br><span class="line">imagePullPolicy: &lt;string&gt;		<span class="comment"># åœ¨podæ¨¡æ¿æ–‡ä»¶ä¸­ï¼Œcontainersä¸‹çº§æŒ‡å®š`imagePullPolicy: æ‹‰å–ç­–ç•¥`ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœé•œåƒçš„tagæ˜¯latestï¼Œæ‹‰å–ç­–ç•¥æ˜¯Alwaysï¼Œå…¶ä»–çš„æƒ…å†µé»˜è®¤éƒ½æ˜¯IfNotPresent</span></span><br></pre></td></tr></table></figure>







<h3 id="å¯èƒ½é‡åˆ°çš„é—®é¢˜"><a href="#å¯èƒ½é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å¯èƒ½é‡åˆ°çš„é—®é¢˜"></a>å¯èƒ½é‡åˆ°çš„é—®é¢˜</h3><p><strong>é—®é¢˜1ï¼šåˆ›å»ºpodæ—¶æŠ¥é”™ï¼šError from server (ServerTimeout): error when creating â€œbusybox.yamlâ€: No API token found for service account â€œdefaultâ€, retry after the token is automatically created and added to the service account</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ˜¯ç”±äºapiserverçš„service accountæ²¡æœ‰è®¾ç½®API tokenå¼•èµ·çš„ï¼Œè§£å†³åŠæ³•ï¼š</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæˆå¯†é’¥</span></span><br><span class="line">[root@master kubernetes]$ openssl genrsa -out /etc/kubernetes/serviceaccount.key 2048</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘apiserveré…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@master kubernetes]$ vim /etc/kubenetes/apiserver</span><br><span class="line">KUBE_API_ARGS=<span class="string">&quot;--service_account_key_file=/etc/kubernetes/serviceaccount.key&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘controller-manageré…ç½®æ–‡ä»¶</span></span><br><span class="line">[root@master kubernetes]$ vim /etc/kubernetes/controller-manager</span><br><span class="line">KUBE_CONTROLLER_MANAGER_ARGS=<span class="string">&quot;--service_account_private_key_file=/etc/kubernetes/serviceaccount.key&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯æ‰€æœ‰æœåŠ¡</span></span><br><span class="line">[root@master kubernetes]$ systemctl restart etcd kube-apiserver kube-controller-manager kube-schedule</span><br></pre></td></tr></table></figure>

<p><strong>é—®é¢˜2ï¼šå®¹å™¨çŠ¶æ€ä¸€ç›´æ˜¯<code>ContainerCreating</code>ï¼ŒæŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯å‘ç°æœ‰é”™è¯¯ï¼šError syncing pod, skipping: failed to â€œStartContainerâ€ for â€œPODâ€ with ImagePullBackOff: â€œBack-off pulling image &quot;registry.access.redhat.com&#x2F;rhel7&#x2F;pod-infrastructure:latest&quot;â€œ</strong></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ˜¯ç”±äºåˆ›å»ºpodæ‰€éœ€çš„åŸºç¡€é•œåƒæ‹‰å–å¤±è´¥ï¼Œéœ€è¦ä¿®æ”¹åŸºç¡€é•œåƒçš„æ‹‰å–åœ°å€</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘æ‰€æœ‰å·¥ä½œèŠ‚ç‚¹ä¸Šçš„kubeleté…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹æ‹‰å–åŸºç¡€é•œåƒçš„åœ°å€ï¼Œé»˜è®¤çš„ä»“åº“å›½å†…è®¿é—®ä¼šæœ‰é—®é¢˜ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ä¸ºç§æœ‰ä»“åº“</span></span><br><span class="line"><span class="comment"># `registry:80`æ˜¯æˆ‘çš„ç§æœ‰é•œåƒä»“åº“çš„åœ°å€ï¼Œ`pod-infrastructure:latest`æ˜¯é•œåƒåï¼Œå¦‚æœç§æœ‰ä»“åº“å†…è¿˜æ²¡æœ‰è¿™ä¸ªé•œåƒè¿˜éœ€è¦æ·»åŠ é•œåƒ</span></span><br><span class="line">[root@node1 kubernetes]$ vim kubelet </span><br><span class="line">KUBELET_POD_INFRA_CONTAINER=<span class="string">&quot;--pod-infra-container-image=registry:80/pod-infrastructure:latest&quot;</span></span><br><span class="line">[root@node1 kubernetes]$ systemctl restart kubelet</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ é•œåƒï¼Œå¦‚æœç§æœ‰ä»“åº“å†…å·²ç»å­˜åœ¨äº†podçš„åŸºç¡€é•œåƒï¼Œåˆ™ä¸éœ€è¦æ­¤æ­¥éª¤</span></span><br><span class="line">|root@aliyun ~|$ docker search pod-infrastructure		<span class="comment"># æœç´¢ä¸€ä¸‹æœ‰å“ªäº›podåŸºç¡€é•œåƒ</span></span><br><span class="line">|root@aliyun ~|$ docker pull tianyebj/pod-infrastructure		<span class="comment"># é€‰æ‹©ä¸€ä¸ªæ‹‰å–åˆ°æœ¬åœ°</span></span><br><span class="line">|root@aliyun ~|$ docker tag tianyebj/pod-infrastructure:latest registry:80/pod-infrastructure		<span class="comment"># æ‰“ä¸ªæ ‡ç­¾</span></span><br><span class="line">|root@aliyun ~|$ docker push registry:80/pod-infrastructure		<span class="comment"># æ¨é€åˆ°ç§æœ‰ä»“åº“</span></span><br></pre></td></tr></table></figure>

<h3 id="podç”Ÿå‘½å‘¨æœŸ"><a href="#podç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="podç”Ÿå‘½å‘¨æœŸ"></a>podç”Ÿå‘½å‘¨æœŸ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Pendingï¼šåˆ›å»ºäº†podèµ„æºå¹¶å­˜å…¥etcdä¸­ï¼Œä½†å°šæœªå®Œæˆè°ƒåº¦ã€‚</span><br><span class="line"></span><br><span class="line">ContainerCreatingï¼šPod çš„è°ƒåº¦å®Œæˆï¼Œè¢«åˆ†é…åˆ°æŒ‡å®š Node ä¸Šã€‚å¤„äºå®¹å™¨åˆ›å»ºçš„è¿‡ç¨‹ä¸­ã€‚é€šå¸¸æ˜¯åœ¨æ‹‰å–é•œåƒçš„è¿‡ç¨‹ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">Runningï¼šPod åŒ…å«çš„æ‰€æœ‰å®¹å™¨éƒ½å·²ç»æˆåŠŸåˆ›å»ºï¼Œå¹¶ä¸”æˆåŠŸè¿è¡Œèµ·æ¥ã€‚</span><br><span class="line"></span><br><span class="line">Succeededï¼šPodä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å·²ç»æˆåŠŸç»ˆæ­¢å¹¶ä¸”ä¸ä¼šè¢«é‡å¯</span><br><span class="line"></span><br><span class="line">Failedï¼šæ‰€æœ‰å®¹å™¨éƒ½å·²ç»ç»ˆæ­¢ï¼Œä½†è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨ç»ˆæ­¢å¤±è´¥ï¼Œä¹Ÿå°±æ˜¯è¯´å®¹å™¨è¿”å›äº†é0å€¼çš„é€€å‡ºçŠ¶æ€æˆ–å·²ç»è¢«ç³»ç»Ÿç»ˆæ­¢ã€‚</span><br><span class="line"></span><br><span class="line">Unknownï¼šå› ä¸ºæŸäº›åŸå› æ— æ³•å–å¾— Pod çš„çŠ¶æ€ã€‚è¿™ç§æƒ…å†µé€šå¸¸æ˜¯å› ä¸ºä¸ Pod æ‰€åœ¨ä¸»æœºé€šä¿¡å¤±è´¥ã€‚</span><br></pre></td></tr></table></figure>





</div><script src="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery) {
        var options1 = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1);
        }</script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2024-03-27</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« é‚“èƒ–èƒ–</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/K8S/'>
                            K8S
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>
                            å­¦ä¹ ç¬”è®°
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    <!-- <div class="post-footer-pre-next">
        <span>ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
        <span class="post-footer-pre-next-last-span-right">ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
    </div> -->

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
             

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery.min.js"></script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>