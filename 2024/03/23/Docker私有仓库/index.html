<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="Dockerä»“åº“" />
    <meta name="hexo-theme-A4" content="v1.9.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Dengpangpang</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Dengpangpang</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">ğŸŸé¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">ğŸ“æ–‡ç« </a></li>
            
        
            
                <li><a href="/tags/">ğŸ·ï¸æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">ğŸ—‚ï¸åˆ†ç±»</a></li>
            
        
            
                <li><a href="/about/">ğŸ‘ï¸å…³äº</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            Dockerä»“åº“
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="post-toc-text">æ¦‚è¿°</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#registry"><span class="post-toc-text">registry</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Harbor"><span class="post-toc-text">Harbor</span></a></li></ol>
            
        
        <link rel="stylesheet" type="text/css" href="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><blockquote>
<p><strong>å…³äºå…±æœ‰é•œåƒDocker Hub</strong></p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://hub.docker.com/">Docker Hub</a>æ˜¯ä¸€ä¸ªå…¬å…±çš„Dockeré•œåƒä»“åº“ï¼Œä½¿ç”¨å‰éœ€è¦åœ¨Docker Hubå®˜ç½‘æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œåˆ›å»ºä¸€ä¸ªä»“åº“ï¼ˆRepositoryï¼‰,æ¯”å¦‚test</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œé•œåƒååº”è¯¥æ˜¯<code>ç”¨æˆ·å/ä»“åº“å:æ ‡ç­¾</code>ï¼Œè¿™æ ·æ‰èƒ½æ­£ç¡®åœ°æ‹‰å–å’Œæ¨é€é•œåƒ</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login		<span class="comment"># è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼Œç™»å½•Docker hubçš„è´¦å·ï¼Œä¹‹åå³å¯åœ¨Docker Hubä¸Šæ‹‰å–å’Œæ¨é€é•œåƒ</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>ä½¿ç”¨Dockerç§æœ‰ä»“åº“çš„åŸå› </strong></p>
</blockquote>
<ol>
<li>é€Ÿåº¦æ…¢ï¼Œå®˜æ–¹çš„é•œåƒä»“åº“åœ¨å›½å¤–ï¼Œè®¿é—®é€Ÿåº¦ä¸è¨€è€Œå–»;</li>
<li>å®‰å…¨æ€§ä½ï¼Œå¦‚æœä¼ä¸šå¼€å‘çš„æ ¸å¿ƒä»£ç ä¸Šä¼ åˆ°å®˜æ–¹çš„é•œåƒä»“åº“ï¼Œè¿™æ„å‘³ç€å¤§å®¶éƒ½èƒ½çœ‹åˆ°ä¼ä¸šå†…éƒ¨çš„ä»£ç ;</li>
</ol>
<blockquote>
<p><strong>ä¸»æµç§æœ‰ä»“åº“æœ‰å“ªäº›</strong></p>
</blockquote>
<ol>
<li>docker-registryï¼šä¸€ä¸ªè½»é‡çº§çš„é•œåƒä»“åº“ï¼ŒåŸºæœ¬ä¸Šä¸å¤ªå ç”¨å†…å­˜ï¼Œå¾ˆé€‚åˆå­¦ä¹ ç¯å¢ƒä¸­ä½¿ç”¨ã€‚</li>
<li>harborï¼šå®¿ä¸»æœºæœ€å°‘éœ€è¦2Gå†…å­˜ï¼Œæ˜¯ä¼ä¸šçš„ä¸»æµåº”ç”¨ã€‚</li>
</ol>
<h2 id="registry"><a href="#registry" class="headerlink" title="registry"></a>registry</h2><blockquote>
<p><strong>éƒ¨ç½²å¯åŠ¨</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker pull registry</span><br><span class="line">docker run -d -p 5000:5000 --restart=always --name registry -v /data/docker_registry:/var/lib/registry registry</span><br></pre></td></tr></table></figure>

<p>åœ¨æµè§ˆå™¨è®¿é—®<code>http://æœåŠ¡ç«¯IP:5000/v2/_catalog</code>å³å¯æŸ¥çœ‹ä»“åº“</p>
<blockquote>
<p><strong>ä¸Šä¼ é•œåƒ</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆè¦æŠŠç§æœ‰é•œåƒä»“åº“çš„åœ°å€æ·»åŠ åˆ°å—ä¿¡ä»»çš„ä»“åº“ï¼Œæ‰èƒ½ä½¿ç”¨httpsåè®®</span></span><br><span class="line">vim /etc/docker/daemon.json		<span class="comment"># æ·»åŠ è¿™å¥ï¼Œå—ä¿¡ä»»ä»“åº“çš„`åŸŸå:ç«¯å£`æˆ–è€…`IP:ç«¯å£`</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;insecure-registries&quot;</span>: [<span class="string">&quot;registry:80&quot;</span>],</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸Šä¼ ä¹‹å‰è¦å…ˆç»™é•œåƒæ‰“ä¸Šæ ‡ç­¾ï¼Œé•œåƒåä¸­å¿…é¡»å«æœ‰ç§æœ‰ä»“åº“åœ°å€ä¿¡æ¯æ‰èƒ½æ­£ç¡®ä¸Šä¼ </span></span><br><span class="line">docker tag åŸé•œåƒå:æ ‡ç­¾ æ–°é•œåƒå:æ ‡ç­¾		<span class="comment"># æ¯”å¦‚ docker tag hello-world registry:80/hello:v1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€</span></span><br><span class="line">docker push é•œåƒå:æ ‡ç­¾		<span class="comment"># æ¯”å¦‚ docker push registry:80/hello:v1</span></span><br></pre></td></tr></table></figure>

<p>åœ¨æµè§ˆå™¨è®¿é—®<code>http://æœåŠ¡ç«¯IP:5000/v2/_catalog</code>å³å¯æŸ¥çœ‹ä»“åº“ä¸­çš„é•œåƒä¿¡æ¯</p>
<blockquote>
<p><strong>å…¶ä»–é•œåƒå‘½ä»¤</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…¶ä»–é•œåƒå‘½ä»¤åŸºæœ¬ä¸Šæ²¡æœ‰å¤ªå¤šå·®å¼‚ï¼Œåƒæ‹‰å–é•œåƒã€åˆ é™¤æœ¬åœ°é•œåƒï¼Œæ­£å¸¸ä½¿ç”¨å‘½ä»¤å³å¯</span></span><br><span class="line">docker pull é•œåƒå:æ ‡ç­¾		<span class="comment"># æ¯”å¦‚ docker pull registry:80/hello:v1</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>åˆ é™¤ä»“åº“ä¸­çš„é•œåƒ</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥å®¹å™¨å†…éƒ¨ï¼Œç„¶åè¿›å…¥é•œåƒçš„å­˜å‚¨ç›®å½•ï¼Œå¯ä»¥å‘ç°æœ‰ä¸¤ä¸ªç›®å½•`blobs`å’Œ`repositories`</span></span><br><span class="line">docker <span class="built_in">exec</span> -it registry sh</span><br><span class="line"><span class="built_in">cd</span> /var/lib/registry/docker/registry/v2</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä¸­repositorieså­˜å‚¨çš„æ˜¯é•œåƒçš„å…ƒæ•°æ®ï¼Œblobså­˜å‚¨çš„æ˜¯å‹ç¼©åçš„é•œåƒæ–‡ä»¶ï¼Œéœ€è¦åˆ†åˆ«åˆ é™¤</span></span><br><span class="line"><span class="built_in">rm</span> -rf repositories/é•œåƒå/		<span class="comment"># åˆ é™¤é•œåƒå…ƒæ•°æ®ï¼Œæ­¤æ—¶æµè§ˆå™¨ä¸­å·²ç»æŸ¥çœ‹ä¸åˆ°è¯¥é•œåƒçš„ä¿¡æ¯</span></span><br><span class="line">registry garbage-collect /etc/docker/registry/config.yml 		<span class="comment"># å›æ”¶æ— ç”¨æ–‡ä»¶ï¼ŒæŠŠæ²¡æœ‰å…ƒæ•°æ®çš„é•œåƒæ–‡ä»¶ç»™æ¸…ç†æ‰</span></span><br></pre></td></tr></table></figure>

<h2 id="Harbor"><a href="#Harbor" class="headerlink" title="Harbor"></a>Harbor</h2><p>harborç§æœ‰é•œåƒä»“åº“æ˜¯åœ¨dockerå®˜æ–¹æä¾›çš„â€registryâ€åŸºç¡€ä¹‹ä¸ŠäºŒæ¬¡å¼€å‘ï¼Œå®ƒåŒ…å«äº†registryçš„æ ¸å¿ƒåŠŸèƒ½ã€‚harborç›¸æ¯”dockerçš„registryä½¿ç”¨èµ·æ¥æ›´åŠ å‹å¥½ï¼ŒåŸºæœ¬ä¸Šå¤§å¤šæ•°æ“ä½œéƒ½æ˜¯åœ¨webç•Œé¢ä¸­å°±èƒ½å®Œæˆã€‚</p>
<blockquote>
<p><strong>éƒ¨ç½²Harbor</strong></p>
</blockquote>
<p>æ³¨æ„ï¼šå®‰è£…harborä¹‹å‰ï¼Œéœ€è¦å…ˆå®‰è£…docker-ceï¼Œdocker-composeï¼Œcontainer.ioï¼Œå¹¶å¯åŠ¨dockerå®ˆæŠ¤è¿›ç¨‹</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½</span></span><br><span class="line">wget https://github.com/goharbor/harbor/releases/download/v2.3.0/harbor-offline-installer-v2.3.0.tgz</span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å‹åˆ°æŒ‡å®šç›®å½•</span></span><br><span class="line">tar xf harbor-offline-installer-v2.3.0.tgz -C /softwares</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cd</span> /softwares/harbor		<span class="comment"># è¿›å…¥harborè½¯ä»¶ç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> harbor.yml.tmpl harbor.yml		<span class="comment"># æ ¹æ®ç¤ºä¾‹é…ç½®æ–‡ä»¶åˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶</span></span><br><span class="line">vim harbor.yml		<span class="comment"># ç¼–è¾‘é…ç½®æ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line">hostname: harbor.study		<span class="comment"># ä¸»æœºåï¼Œä½œä¸ºè®¿é—®åŸŸå</span></span><br><span class="line">http:</span><br><span class="line">  port: 80		<span class="comment"># httpç«¯å£ï¼Œé»˜è®¤80ä¸€èˆ¬æ— éœ€ä¿®æ”¹</span></span><br><span class="line">harbor_admin_password: 123456		<span class="comment"># åˆå§‹ç™»å½•å¯†ç ï¼Œç”¨æˆ·åæ˜¯admin</span></span><br><span class="line">database:</span><br><span class="line">  password: 123456		<span class="comment"># æ•°æ®åº“å¯†ç </span></span><br><span class="line">  max_idle_conns: 100</span><br><span class="line">  max_open_conns: 900</span><br><span class="line">data_volume: /data		<span class="comment"># å­˜å‚¨å·çš„ç›®å½•ï¼Œä¼šè‡ªåŠ¨åˆ›å»º</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…harbor,ç­‰å¾…å®‰è£…å®Œæˆå³å¯</span></span><br><span class="line">sh ./install.sh		</span><br></pre></td></tr></table></figure>

<p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®<code>harbor.study</code>å³å¯è¿›å…¥åˆ°harborä»“åº“çš„webé¡µé¢</p>
<blockquote>
<p><strong>åŸºæœ¬ä½¿ç”¨</strong></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŒæ ·çš„ï¼Œéœ€è¦æŠŠharborä»“åº“ä½œä¸ºå—ä¿¡ä»»çš„ä»“åº“åœ°å€æ·»åŠ åˆ°dockeræœåŠ¡ç«¯çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œç„¶åé‡å¯dockeræœåŠ¡ç«¯</span></span><br><span class="line">vim /etc/docker/daemon.json</span><br><span class="line"></span><br><span class="line">  <span class="string">&quot;insecure-registries&quot;</span>: [<span class="string">&quot;registry:80&quot;</span>,<span class="string">&quot;study.harbor&quot;</span>],</span><br><span class="line"></span><br><span class="line">systemctl restart docker</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç™»å½•harborç§æœ‰ä»“åº“</span></span><br><span class="line">docker login harbor.study</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»™é•œåƒæ‰“æ ‡ç­¾ï¼Œæ–°é•œåƒåä¸­å¿…é¡»å«æœ‰ç§æœ‰ä»“åº“çš„åœ°å€ä¿¡æ¯ï¼Œä»¥åŠé¡¹ç›®å</span></span><br><span class="line">docker tag åŸé•œåƒå:æ ‡ç­¾ æ–°é•œåƒå:æ ‡ç­¾</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¨é€ã€æ‹‰å–ã€åˆ é™¤æœ¬åœ°é•œåƒç­‰æ“ä½œæ²¡æœ‰å¤ªå¤§å·®å¼‚</span></span><br></pre></td></tr></table></figure>

</div><script src="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery) {
        var options1 = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1);
        }</script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2024-03-23</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« é‚“èƒ–èƒ–</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/Docker/'>
                            Docker
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>
                            å­¦ä¹ ç¬”è®°
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    <!-- <div class="post-footer-pre-next">
        <span>ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
        <span class="post-footer-pre-next-last-span-right">ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
    </div> -->

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
             

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery.min.js"></script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>