<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="Ansibleæ ¸å¿ƒæ¨¡å—ï¼ˆä¸Šï¼‰" />
    <meta name="hexo-theme-A4" content="v1.9.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Dengpangpang</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Dengpangpang</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">ğŸŸé¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">ğŸ“æ–‡ç« </a></li>
            
        
            
                <li><a href="/tags/">ğŸ·ï¸æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">ğŸ—‚ï¸åˆ†ç±»</a></li>
            
        
            
                <li><a href="/about/">ğŸ‘ï¸å…³äº</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            Ansibleæ ¸å¿ƒæ¨¡å—ï¼ˆä¸Šï¼‰
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#command-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">command æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#shell-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">shell æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#script-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">script æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#hostname%E6%A8%A1%E5%9D%97"><span class="post-toc-text">hostnameæ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#copy-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">copy æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#template%E6%A8%A1%E5%9D%97"><span class="post-toc-text">templateæ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#fetch-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">fetch æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#file-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">file æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#archive-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">archive æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#unarchive-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">unarchive æ¨¡å—</span></a></li></ol>
            
        
        <link rel="stylesheet" type="text/css" href="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/css/lightgallery.min.css" /><div class=".article-gallery"><h3 id="command-æ¨¡å—"><a href="#command-æ¨¡å—" class="headerlink" title="command æ¨¡å—"></a>command æ¨¡å—</h3><p>åœ¨è¿œç¨‹ä¸»æœºæ‰§è¡Œå‘½ä»¤ï¼Œæ­¤ä¸ºé»˜è®¤æ¨¡å—ï¼Œå¯å¿½ç•¥-mé€‰é¡¹</p>
<p>æ³¨æ„ï¼šæ­¤å‘½ä»¤ä¸æ”¯æŒ <code>$VARNAME  &lt;  &gt;  |  ;  &amp; </code>  ç­‰ç¬¦å·ï¼Œå¯ä»¥ç”¨shellæ¨¡å—å®ç°ã€‚</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>chdir</strong> path</td>
<td>Change into this directory before running the command.</td>
</tr>
<tr>
<td><strong>removes</strong> path</td>
<td>A filename or (since 2.0) glob pattern. If a matching file exists, this step <strong>will</strong> be run.</td>
</tr>
<tr>
<td><strong>creates</strong> path</td>
<td>A filename or glob pattern. If a matching file already exists, this step <strong>will not</strong> be run.This is checked before <code>[removes]</code></td>
</tr>
<tr>
<td><strong>cmd</strong> string</td>
<td>The command to run.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m command -a &quot;cmd&quot;</code>ï¼Œ<code>-m command </code>é»˜è®¤å¯ä»¥ä¸åŠ ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥è¿è¡Œå‘½ä»¤</span></span><br><span class="line">ansible all -a <span class="string">&#x27;hostname&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># chdirå‚æ•°ï¼Œåˆ‡æ¢ç›®å½•</span></span><br><span class="line">ansible websrvs -a <span class="string">&#x27;chdir=/opt touch b.txt&#x27;</span>  <span class="comment">#å…ˆåˆ‡æ¢ç›®å½•å†åˆ›å»ºæ–‡ä»¶ã€‚ä¸æŒ‡å®šç›®å½•ä¼šåˆ›å»ºåˆ°å®¶ç›®å½•ä¸‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># createså‚æ•°ï¼Œåˆ›å»ºæ–‡ä»¶</span></span><br><span class="line">ansible websrvs -a <span class="string">&#x27;creates=/etc/fstab rm -f /opt/b.txt&#x27;</span>	<span class="comment"># è¿™ä¸ªæ–‡ä»¶å­˜åœ¨ï¼Œæ‰€ä»¥ä¸æ‰§è¡Œåé¢çš„rmæ“ä½œ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># removeså‚æ•°ï¼Œç§»é™¤æ–‡ä»¶</span></span><br><span class="line">ansible websrvs -a <span class="string">&#x27;removes=/etc/fstab rm -f /opt/b.txt&#x27;</span>	<span class="comment"># æ–‡ä»¶å­˜åœ¨ï¼Œæ‰€ä»¥æ‰§è¡Œåé¢çš„rmæ“ä½œ</span></span><br></pre></td></tr></table></figure>





<h3 id="shell-æ¨¡å—"><a href="#shell-æ¨¡å—" class="headerlink" title="shell æ¨¡å—"></a>shell æ¨¡å—</h3><p>å’Œcommandç›¸ä¼¼ï¼Œç”¨shellæ‰§è¡Œå‘½ä»¤</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>executable</strong> path</td>
<td>Change the shell used to execute the command.This expects an absolute path to the executable.</td>
</tr>
<tr>
<td><strong>chdir</strong> path</td>
<td>Change into this directory before running the command.</td>
</tr>
<tr>
<td><strong>creates</strong> path</td>
<td>A filename, when it already exists, this step will <strong>not</strong> be run.</td>
</tr>
<tr>
<td><strong>removes</strong> path</td>
<td>A filename, when it does not exist, this step will <strong>not</strong> be run.</td>
</tr>
<tr>
<td><strong>cmd</strong> string</td>
<td>The command to run followed by optional arguments.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m shell -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç›´æ¥è¿è¡Œå‘½ä»¤ï¼Œæ”¯æŒ $VARNAME &lt;  &gt;  |  ;  &amp;  ç­‰ç¬¦å·</span></span><br><span class="line">ansible websrvs -m shell -a <span class="string">&quot;echo <span class="variable">$HOSTNAME</span>&quot;</span></span><br><span class="line">ansible websrvs -m shell -a <span class="string">&quot;echo hello &gt;/opt/hello.txt&quot;</span></span><br></pre></td></tr></table></figure>



<h3 id="script-æ¨¡å—"><a href="#script-æ¨¡å—" class="headerlink" title="script æ¨¡å—"></a>script æ¨¡å—</h3><p>åœ¨è¿œç¨‹ä¸»æœºä¸Šè¿è¡ŒansibleæœåŠ¡å™¨ä¸Šçš„shellè„šæœ¬æˆ–pythonè„šæœ¬ï¼ˆæ— éœ€æ‰§è¡Œæƒé™ï¼‰</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>executable</strong> string</td>
<td>Name or path of an executable to invoke the script with.</td>
</tr>
<tr>
<td><strong>chdir</strong> string</td>
<td>Change into this directory on the remote node before running the script.</td>
</tr>
<tr>
<td><strong>creates</strong> string</td>
<td>A filename on the remote node, when it already exists, this step will <strong>not</strong> be run.</td>
</tr>
<tr>
<td><strong>removes</strong> string</td>
<td>A filename on the remote node, when it does not exist, this step will <strong>not</strong> be run.</td>
</tr>
<tr>
<td><strong>cmd</strong> string</td>
<td>Path to the local script to run followed by optional arguments.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m script -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ll /data/test.sh			<span class="comment"># æŸ¥çœ‹æœ¬æœºè„šæœ¬ä¿¡æ¯ï¼Œæ— æ‰§è¡Œæƒé™</span></span><br><span class="line">-rw-r--r-- 1 root root 22 Jul 15 14:17 /data/test.sh	</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿œç¨‹æ‰§è¡Œ</span></span><br><span class="line">ansible websrvs -m script -a <span class="string">&#x27;/data/test.sh&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="hostnameæ¨¡å—"><a href="#hostnameæ¨¡å—" class="headerlink" title="hostnameæ¨¡å—"></a>hostnameæ¨¡å—</h3><p>ç®¡ç†è¿œç¨‹ä¸»æœºçš„ä¸»æœºå</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>name</strong> string &#x2F; ï¼ˆrequiredï¼‰</td>
<td>Name of the host.If the value is a fully qualified domain name that does not resolve from the given host, this will cause the module to hang for a few seconds while waiting for the name resolution attempt to timeout.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m hostname -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ›´æ”¹192.168.20.22çš„ä¸»æœºåä¸ºnginx01,/etc/hostnameæ–‡ä»¶å†…å®¹ä¹Ÿè¢«ä¿®æ”¹</span></span><br><span class="line">ansible 192.168.20.22 -m hostname -a <span class="string">&#x27;name=nginx01&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="copy-æ¨¡å—"><a href="#copy-æ¨¡å—" class="headerlink" title="copy æ¨¡å—"></a>copy æ¨¡å—</h3><p>ä»ansibleæœåŠ¡å™¨ä¸»æ§ç«¯å¤åˆ¶æ–‡ä»¶åˆ°è¿œç¨‹ä¸»æœº</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>backup</strong> boolean</td>
<td>Create a backup file including the timestamp information so you can get the original file back if you somehow clobbered it incorrectly. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>src</strong> path</td>
<td>Local path to a file to copy to the remote server.This can be absolute or relative.<br />If path is a directory, it is copied recursively.<br /> In this case, if path ends with â€œ&#x2F;â€, only inside contents of that directory are copied to destination. <br />Otherwise, if it does not end with â€œ&#x2F;â€, the directory itself with all contents is copied. <br />This behavior is similar to the <code>rsync</code> command line tool.</td>
</tr>
<tr>
<td><strong>remote_src</strong> boolean</td>
<td>Influence whether <code>[src]</code> needs to be transferred or already is present remotely. Default choice is <code>false</code><br /> If <code>false</code>, it will search for <code>[src]</code> on the controller node.If <code>true</code> it will search for <code>[src]</code> on the managed (remote) node.<br /><code>[remote_src]</code> supports recursive copying as of version 2.8.<br /><code>[remote_src]</code> only works with <code>mode=preserve</code> as of version 2.6. <br />Autodecryption of files does not work when <code>remote_src=yes</code>.</td>
</tr>
<tr>
<td><strong>dest</strong> path &#x2F; ï¼ˆ<strong>required</strong>ï¼‰</td>
<td>Remote absolute path where the file should be copied to.<br />If <code>[src]</code> is a directory, this must be a directory too.<br />If <code>[dest]</code> is not exist and if either <code>[dest]</code> ends with <code>/</code> or <code>[src]</code> is a directory, <code>[dest]</code> is created.<br />If <code>[dest]</code> is a relative path, the starting directory is determined by the remote host.<br />If <code>[src]</code> and <code>[dest]</code> are files, the parent directory of <code>[dest]</code> is not created and the task fails if it does not already exist.</td>
</tr>
<tr>
<td><strong>mode</strong> any</td>
<td>The permissions of the destination file or directory. You must either add a leading zero so that Ansibleâ€™s YAML parser knows it is an octal number (like <code>0644</code> or <code>01777</code>) or quote it (like <code>&#39;644&#39;</code> or <code>&#39;1777&#39;</code>) so Ansible receives a string and can do its own conversion from string into number.</td>
</tr>
<tr>
<td><strong>owner</strong> string</td>
<td>Name of the user that should own the filesystem object, as would be fed to <em>chown</em>.When left unspecified, it uses the current user unless you are root, in which case it can preserve the previous ownership.Specifying a numeric username will be assumed to be a user ID and not a username. Avoid numeric usernames to avoid this confusion.</td>
</tr>
<tr>
<td><strong>group</strong> string</td>
<td>Name of the group that should own the filesystem object, as would be fed to <em>chown</em>.When left unspecified, it uses the current group of the current user unless you are root, in which case it can preserve the previous ownership.</td>
</tr>
<tr>
<td><strong>directory_mode</strong> any</td>
<td>Set the access permissions of newly created directories to the given mode. Permissions on existing directories do not change.See <code>[mode]</code> for the syntax of accepted values.The target systemâ€™s defaults determine permissions when this parameter is not set.</td>
</tr>
<tr>
<td><strong>content</strong> string</td>
<td>When used instead of <code>[src]</code>, sets the contents of a file directly to the specified value.<br />Works only when <code>[dest]</code> is a file.<br /> Creates the file if it does not exist.<br />For advanced formatting or if <code>[content]</code> contains a variable, use the <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html#ansible-collections-ansible-builtin-template-module">ansible.builtin.template</a> module.</td>
</tr>
<tr>
<td><strong>follow</strong> boolean</td>
<td>This flag indicates that filesystem links in the destination, if they exist, should be followed. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>local_follow</strong> boolean</td>
<td>This flag indicates that filesystem links in the source tree, if they exist, should be followed. Default choice is <code>true</code></td>
</tr>
<tr>
<td><strong>force</strong> boolean</td>
<td>Influence whether the remote file must always be replaced. Default choice is <code>true</code><br />If <code>true</code>, the remote file will be replaced when contents are different than the source.<br />If <code>false</code>, the file will only be transferred if the destination does not exist.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m copy -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚ç›®æ ‡å­˜åœ¨ï¼Œé»˜è®¤è¦†ç›–ï¼Œæ­¤å¤„æŒ‡å®šå…ˆå¤‡ä»½ï¼Œè¦æœ‰ownerç”¨æˆ·ï¼Œå¦åˆ™æŠ¥é”™ï¼Œ</span></span><br><span class="line"><span class="comment"># å†æ¬¡å¤åˆ¶ï¼Œç”±äºtest1.shå†…å®¹ä¸å˜ï¼Œæ‰€ä»¥æ ¹æ®ansibleçš„å¹‚ç­‰æ€§ï¼Œä¸ä¼šç”Ÿæˆå¤‡ä»½æ–‡ä»¶ï¼Œæ˜¾ç¤ºæ˜¯successè€Œéchanged</span></span><br><span class="line"><span class="comment"># ä¿®æ”¹test1.shæ–‡ä»¶åï¼Œå†æ¬¡å¤åˆ¶ï¼Œä¼šç”Ÿæˆå¤‡ä»½æ–‡ä»¶ï¼Œæ–‡ä»¶åä¸ºtest2.sh.å¤‡ä»½åºå·.æ—¶é—´æˆ³</span></span><br><span class="line">ansible websrvs -m copy -a <span class="string">&quot;src=/root/test1.sh dest=/tmp/test2.sh owner=wang mode=600 backup=yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æŒ‡å®šå†…å®¹ï¼Œç›´æ¥ç”Ÿæˆç›®æ ‡æ–‡ä»¶ï¼›å¦‚æœç›®æ ‡æ–‡ä»¶å­˜åœ¨ï¼Œä¼šè¦†ç›–å…¶å†…å®¹ï¼›å¦‚æœç›®æ ‡æ–‡ä»¶çš„çˆ¶ç›®å½•ä¸å­˜åœ¨ï¼Œä¼šæŠ¥é”™</span></span><br><span class="line">ansible websrvs -m copy -a <span class="string">&quot;content=&#x27;test line1\ntest line2&#x27; dest=/opt/test1.sh&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¤åˆ¶/etc/sysconfigç›®å½•ã€‚å¦‚æœdestæ˜¯ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„ä¸”ä»¥â€œ/â€ç»“å°¾ï¼Œæˆ–è€…srcæ˜¯ä¸€ä¸ªç›®å½•ï¼Œåˆ™ä¼šåˆ›å»ºdestç›®å½•ã€‚</span></span><br><span class="line">ansible websrvs -m copy -a <span class="string">&quot;src=/etc/sysconfig dest=/opt/test/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¤åˆ¶/etc/sysconfigä¸‹çš„æ–‡ä»¶ï¼Œä¸åŒ…æ‹¬/etc/sysconfigç›®å½•è‡ªèº«ï¼Œæ³¨æ„/sysconfigåé¢æœ‰/</span></span><br><span class="line">ansible websrvs -m copy -a <span class="string">&quot;src=/etc/sysconfig/ dest=/opt&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="templateæ¨¡å—"><a href="#templateæ¨¡å—" class="headerlink" title="templateæ¨¡å—"></a>templateæ¨¡å—</h3><p><code>template</code>æ¨¡å—ä½¿ç”¨äº†<a target="_blank" rel="noopener" href="https://leohsiao.com/Python/%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86/%E5%BA%8F%E5%88%97%E5%8C%96/Jinja.html"><code>Jinjia2</code></a>æ¨¡æ¿è¯­è¨€ï¼Œå¯ä»¥æŒ‰éœ€æ±‚ä¿®æ”¹é…ç½®æ–‡ä»¶å†…å®¹æ¥å¤åˆ¶æ¨¡æ¿åˆ°è¢«æ§ä¸»æœºä¸Šã€‚</p>
<p>templateæ¨¡å—ç”¨æ³•å’Œcopyæ¨¡å—ç”¨æ³•åŸºæœ¬ä¸€è‡´ï¼Œå®ƒä¸»è¦ç”¨äºå¤åˆ¶é…ç½®æ–‡ä»¶ï¼Œä¸åŒçš„æ˜¯ï¼Œtemplateæ¨¡å—éœ€è¦å…ˆå»ºç«‹ä¸€ä¸ªä½¿ç”¨<code>*.j2</code>ä¸ºæ–‡ä»¶åç¼€çš„æ¨¡æ¿æ–‡ä»¶ã€‚</p>
<p>æ¨¡ç‰ˆä¸­å¯ä»¥ä½¿ç”¨å¦‚ä¸‹6ä¸ªå˜é‡ä»¥åŠå…¶ä»–è‡ªå®šä¹‰çš„å˜é‡ï¼š</p>
<ul>
<li><code>ansible_managed</code> - åŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ç”¨äºæè¿°æ¨¡æ¿åç§°ï¼Œä¸»æœºï¼Œæ¨¡æ¿æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´å’Œæ‰€æœ‰è€…çš„uid</li>
<li><code>template_host</code> - åŒ…å«æ¨¡æ¿æœºå™¨çš„èŠ‚ç‚¹åç§°</li>
<li><code>template_uid</code> - æ‰€æœ‰è€…çš„uid</li>
<li><code>template_path</code> - æ¨¡ç‰ˆè·¯å¾„</li>
<li><code>template_fullpath</code> - æ¨¡ç‰ˆçš„ç»å¯¹è·¯å¾„</li>
<li><code>template_run_date</code> - æ¨¡ç‰ˆå‘ˆç°çš„æ—¶é—´</li>
</ul>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>backup</strong> boolean</td>
<td>Create a backup file including the timestamp information so you can get the original file back if you somehow clobbered it incorrectly. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>block_start_string</strong> string</td>
<td>The string marking the beginning of a block.<strong>Default:</strong> <code>&quot;&#123;%"` |
| **block_end_string** string                      | The string marking the end of a block.**Default:** `"%&#125;&quot;</code></td>
</tr>
<tr>
<td><strong>variable_start_string</strong> string</td>
<td>The string marking the beginning of a print statement.<strong>Default:</strong> <code>&quot;&#123;&#123;"` |
| **variable_end_string** string                   | The string marking the end of a print statement.**Default:** `"&#125;&#125;&quot;</code></td>
</tr>
<tr>
<td><strong>comment_end_string</strong> string</td>
<td>The string marking the end of a comment statement.  added in ansible-core 2.12</td>
</tr>
<tr>
<td><strong>comment_start_string</strong> string</td>
<td>The string marking the beginning of a comment statement.  added in ansible-core 2.12</td>
</tr>
<tr>
<td><strong>lstrip_blocks</strong> boolean</td>
<td>Determine when leading spaces and tabs should be stripped.When set to <code>yes</code> leading spaces and tabs are stripped from the start of a line to a block. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>trim_blocks</strong> boolean</td>
<td>Determine when newlines should be removed from blocks.When set to <code>yes</code> the first newline after a block is removed (block, not variable tag!).  Default choice is <code>true</code></td>
</tr>
<tr>
<td><strong>newline_sequence</strong> string</td>
<td>Specify the newline sequence to use for templating files.<strong>Choices:</strong><code>&quot;\n&quot;</code> â† (default) or <code>&quot;\r&quot;</code>ï¼Œ<code>&quot;\r\n&quot;</code></td>
</tr>
<tr>
<td><strong>output_encoding</strong> string<em>added in Ansible 2.7</em></td>
<td>Overrides the encoding used to write the template file defined by <code>[dest]</code>. It defaults to <code>utf-8</code>, but any encoding supported by python can be used.The source template file must always be encoded using <code>utf-8</code>.</td>
</tr>
<tr>
<td><strong>dest</strong> path &#x2F; ï¼ˆrequiredï¼‰</td>
<td>Location to render the template to on the remote machine.</td>
</tr>
<tr>
<td><strong>src</strong> path &#x2F; required</td>
<td>Path of a Jinja2 formatted template on the Ansible controller.This can be a relative or an absolute path.The file must be encoded with <code>utf-8</code> but <code>[output_encoding]</code> can be used to control the encoding of the output template.</td>
</tr>
<tr>
<td><strong>mode</strong> any</td>
<td>The permissions of the destination file or directory. You must either add a leading zero so that Ansibleâ€™s YAML parser knows it is an octal number (like <code>0644</code> or <code>01777</code>) or quote it (like <code>&#39;644&#39;</code> or <code>&#39;1777&#39;</code>) so Ansible receives a string and can do its own conversion from string into number.</td>
</tr>
<tr>
<td><strong>owner</strong> string</td>
<td>Name of the user that should own the filesystem object, as would be fed to <em>chown</em>.When left unspecified, it uses the current user unless you are root, in which case it can preserve the previous ownership.Specifying a numeric username will be assumed to be a user ID and not a username. Avoid numeric usernames to avoid this confusion.</td>
</tr>
<tr>
<td><strong>group</strong> string</td>
<td>Name of the group that should own the filesystem object, as would be fed to <em>chown</em>.When left unspecified, it uses the current group of the current user unless you are root, in which case it can preserve the previous ownership.</td>
</tr>
<tr>
<td><strong>follow</strong> boolean</td>
<td>This flag indicates that filesystem links in the destination, if they exist, should be followed. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>force</strong> boolean</td>
<td>Influence whether the remote file must always be replaced. Default choice is <code>true</code><br />If <code>true</code>, the remote file will be replaced when contents are different than the source.<br />If <code>false</code>, the file will only be transferred if the destination does not exist.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m template -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸copyæ¨¡å—å¤§è‡´ç›¸åŒ</span></span><br><span class="line">ansible websrvs -m template -a <span class="string">&quot;src=/root/test1.txt.j2 dest=/tmp/test2.txt backup=yes&quot;</span></span><br></pre></td></tr></table></figure>







<h3 id="fetch-æ¨¡å—"><a href="#fetch-æ¨¡å—" class="headerlink" title="fetch æ¨¡å—"></a>fetch æ¨¡å—</h3><p>ä»è¿œç¨‹ä¸»æœºæå–æ–‡ä»¶è‡³ansibleçš„ä¸»æ§ç«¯ï¼Œä¸copyç›¸åã€‚Fetchç›®å‰ä¸æ”¯æŒç›®å½•ã€‚</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>dest</strong> string &#x2F; (required)</td>
<td>A directory to save the file into.For example, if the <code>[dest]</code> directory is <code>/backup</code>.  a <code>[src]</code> file named <code>/etc/profile</code> on host <code>host.example.com</code>, would be saved into <code>/backup/host.example.com/etc/profile</code>. The host name is based on the inventory name.</td>
</tr>
<tr>
<td><strong>src</strong> string &#x2F; (required)</td>
<td>The file on the remote system to fetch.This <em>must</em> be a file, not a directory.Recursive fetching may be supported in a later release.</td>
</tr>
<tr>
<td><strong>fail_on_missing</strong> boolean</td>
<td>When set to <code>true</code>, the task will fail if the remote file cannot be read for any reason.Prior to Ansible 2.5, setting this would only fail if the source file was missing.The default was changed to <code>true</code> in Ansible 2.5.<br />Default choice is <code>true</code></td>
</tr>
<tr>
<td><strong>flat</strong> boolean</td>
<td>Allows you to override the default behavior of appending hostname&#x2F;path&#x2F;to&#x2F;file to the destination.<br />If <code>[dest]</code> ends with â€˜&#x2F;â€™, it will use the basename of the source file, similar to the copy module.<br />This can be useful if working with a single host, or if retrieving files that are uniquely named per host.If using multiple hosts with the same filename, the file will be overwritten for each host.<br />Default choice is <code>false</code></td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m fetch -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æå–æ‰€æœ‰è¿œç¨‹ä¸»æœºçš„æ–‡ä»¶åˆ°å½“å‰ä¸»æ§ç«¯çš„/data/osç›®å½•ä¸‹ï¼Œå¹¶æŒ‰è¿œç¨‹ä¸»æœºçš„ipåœ°å€åˆ›å»ºå„è‡ªçš„ç›®å½•å­˜æ”¾</span></span><br><span class="line">ansible db01 -m fetch -a <span class="string">&quot;src=/opt/22.txt dest=/root/os&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¼šåˆ›å»º/data/osç›®å½•ï¼Œå¹¶åœ¨å…¶ç›®å½•ä¸‹åˆ›å»ºä¸»æœºåå‘½åçš„ç›®å½•å­˜æ”¾æ–‡ä»¶</span></span><br><span class="line">|root@m01 ~|$ tree /root</span><br><span class="line">/root</span><br><span class="line">â”œâ”€â”€ anaconda-ks.cfg</span><br><span class="line">â””â”€â”€ os</span><br><span class="line">    â””â”€â”€ db01</span><br><span class="line">        â””â”€â”€ opt</span><br><span class="line">            â””â”€â”€ 22.txt</span><br></pre></td></tr></table></figure>



<h3 id="file-æ¨¡å—"><a href="#file-æ¨¡å—" class="headerlink" title="file æ¨¡å—"></a>file æ¨¡å—</h3><p>æ–‡ä»¶æˆ–ç›®å½•ç›¸å…³</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>follow</strong> boolean</td>
<td>This flag indicates that filesystem links, if they exist, should be followed.<code>follow=yes</code> and <code>state=link</code> can modify <code>[src]</code> when combined with parameters such as <code>[mode]</code>.<br />Previous to Ansible 2.5, this was <code>false</code> by default. Default choice is <code>true</code></td>
</tr>
<tr>
<td><strong>force</strong> boolean</td>
<td>Force the creation of the symlinks in two cases: <br />the source file does not exist (but will appear later); <br />the destination exists and is a file (so, we need to unlink the <code>[path]</code> file and create symlink to the <code>[src]</code> file in place of it). <br />Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>owner</strong> string</td>
<td>Name of the user that should own the filesystem object, as would be fed to <em>chown</em>.When left unspecified, it uses the current user unless you are root, in which case it can preserve the previous ownership.Specifying a numeric username will be assumed to be a user ID and not a username. Avoid numeric usernames to avoid this confusion.</td>
</tr>
<tr>
<td><strong>group</strong> string</td>
<td>Name of the group that should own the filesystem object, as would be fed to <em>chown</em>.When left unspecified, it uses the current group of the current user unless you are root, in which case it can preserve the previous ownership.</td>
</tr>
<tr>
<td><strong>mode</strong> any</td>
<td>The permissions of the destination file or directory. You must either add a leading zero so that Ansibleâ€™s YAML parser knows it is an octal number (like <code>0644</code> or <code>01777</code>) or quote it (like <code>&#39;644&#39;</code> or <code>&#39;1777&#39;</code>) so Ansible receives a string and can do its own conversion from string into number.</td>
</tr>
<tr>
<td><strong>src</strong> path</td>
<td>Path of the file to link to.This applies only to <code>state=link</code> and <code>state=hard</code>.<br />For <code>state=link</code>, this will also accept a non-existing path.<br />Relative paths are relative to the file being created (<code>[path]</code>) which is how the Unix command <code>ln -s SRC DEST</code> treats relative paths.</td>
</tr>
<tr>
<td><strong>path</strong> aliases: dest, namepath &#x2F; required</td>
<td>Path to the file being managed.</td>
</tr>
<tr>
<td><strong>recurse</strong> boolean</td>
<td>Recursively set the specified file attributes on directory contents.This applies only when <code>[state]</code> is set to <code>directory</code>.<br />Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>state</strong> string</td>
<td>If <code>absent</code>, directories will be recursively deleted, and files or symlinks will be unlinked. <br />If <code>directory</code>, all intermediate subdirectories will be created if they do not exist. Since Ansible 1.7 they will be created with the supplied permissions.<br />If <code>file</code>, with no other options, returns the current state of <code>path</code>.<br />If <code>file</code>, even with other options (such as <code>[mode]</code>), the file will be modified if it exists but will NOT be created if it does not exist. <br />Set to <code>touch</code> or use the <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html#ansible-collections-ansible-builtin-copy-module">ansible.builtin.copy</a> or <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html#ansible-collections-ansible-builtin-template-module">ansible.builtin.template</a> module if you want to create the file if it does not exist.<br />If <code>hard</code>, the hard link will be created or changed.<br />If <code>link</code>, the symbolic link will be created or changed.<br />If <code>touch</code> (new in 1.4), an empty file will be created if the file does not exist, while an existing file or directory will receive updated file access and modification times (similar to the way <code>touch</code> works from the command line).Default is the current state of the file if it exists, <code>directory</code> if <code>recurse=yes</code>, or <code>file</code> otherwise.<br /><strong>Choices:</strong><code>&quot;absent&quot;``&quot;directory&quot;``&quot;file&quot;``&quot;hard&quot;``&quot;link&quot;``&quot;touch&quot;</code></td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m file -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç©ºç™½æ–‡ä»¶</span></span><br><span class="line">ansible websrvs -m file -a <span class="string">&quot;path=/opt/test.sh state=touch&quot;</span>	</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶æƒé™ï¼Œæ²¡æœ‰æŒ‡å®šç”¨æˆ·ä¼šå¤±è´¥,ä¿®æ”¹ç›®å½•æƒé™æ—¶ï¼Œå¯ä»¥æŒ‡å®š recurse=yes è¡¨ç¤ºé€’å½’ä¿®æ”¹</span></span><br><span class="line">ansible websrvs -m file -a <span class="string">&quot;path=/opt/test.sh owner=wang mode=755&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºç›®å½•</span></span><br><span class="line">ansible all -m file -a <span class="string">&quot;path=/data/mysql state=directory owner=mysql group=mysql&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä½¿ç”¨mkdirç­‰Linuxå‘½ä»¤åˆ›å»ºæ–‡ä»¶æˆ–ç›®å½•ï¼Œé‡å¤åˆ›å»ºä¼šæŠ¥é”™ã€‚ä½¿ç”¨fileå‘½ä»¤åˆ™ä¸ä¼š</span></span><br><span class="line">ansible websrvs -a <span class="string">&quot;mkdir /data/dir2&quot;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ï¼Œä½¿ç”¨state=absent</span></span><br><span class="line">ansible websrvs -m file -a <span class="string">&quot;path=/data/dir2 state=absent&quot;</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ›å»ºè½¯é“¾æ¥ï¼ŒåŸæ–‡ä»¶æ˜¯åœ¨ç›®æ ‡ä¸»æœºæŒ‡å®šçš„ç›®å½•ä¸­ï¼Œå¦åˆ™å¤±è´¥</span></span><br><span class="line">ansible all -m file -a <span class="string">&#x27;src=/data/testfile dest=/data/testfile-link state=link&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="archive-æ¨¡å—"><a href="#archive-æ¨¡å—" class="headerlink" title="archive æ¨¡å—"></a>archive æ¨¡å—</h3><p>å°†è¿œç¨‹ä¸»æœºçš„ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•æ‰“åŒ…å‹ç¼©</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody><tr>
<td>path</td>
<td>è¦å‹ç¼©çš„æ–‡ä»¶æˆ–ç›®å½•</td>
</tr>
<tr>
<td>dest</td>
<td>å‹ç¼©åçš„æ–‡ä»¶</td>
</tr>
<tr>
<td>format</td>
<td>æŒ‡å®šæ‰“åŒ…å‹ç¼©çš„ç±»å‹ï¼šbz2ã€gzã€tarã€xzã€zip</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m unarchive -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†ç›®æ ‡ä¸»æœºçš„/etc/sysconfigæ–‡ä»¶æ‰“åŒ…å‹ç¼©ï¼Œä¿å­˜ä¸º/opt/sys.tar.bz2</span></span><br><span class="line">ansible websrvs -m archive -a <span class="string">&#x27;path=/etc/sysconfig dest=/opt/sys.tar.bz2 format=bz2 owner=haha mode=0600&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="unarchive-æ¨¡å—"><a href="#unarchive-æ¨¡å—" class="headerlink" title="unarchive æ¨¡å—"></a>unarchive æ¨¡å—</h3><p>è§£åŒ…è§£å‹ç¼©</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th align="left">Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>copy</strong> boolean</td>
<td align="left">If true, the file is copied from local controller to the managed (remote) node, otherwise, the plugin will look for src archive on the managed machine.<br />å½“copy&#x3D;yesï¼Œæ‹·è´çš„æ–‡ä»¶æ˜¯ä»ansibleä¸»æœºå¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºä¸Šï¼Œå¦‚æœè®¾ç½®ä¸ºnoï¼Œä¼šåœ¨è¿œç¨‹ä¸»æœºä¸Šå¯»æ‰¾srcæºæ–‡ä»¶<br />This option has been deprecated in favor of <code>[remote_src]</code>. Exclusive with <code>[remote_src]</code>.<br />Default choice is <code>true</code></td>
</tr>
<tr>
<td><strong>remote_src</strong> boolean</td>
<td align="left">Set to <code>true</code> to indicate the archived file is already on the remote system and not local to the Ansible controller.<br />è®¾ç½®ä¸º <code>true</code> è¡¨ç¤ºå­˜æ¡£æ–‡ä»¶å·²ç»åœ¨è¿œç¨‹ç³»ç»Ÿä¸Šï¼Œè€Œä¸æ˜¯åœ¨ Ansible æ§åˆ¶å™¨æœ¬åœ°<br />Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>src</strong> path &#x2F; required</td>
<td align="left">If <code>remote_src=no</code> (default), local path to archive file to copy to the target server; can be absolute or relative.<br /> If <code>remote_src=yes</code>, path on the target server to existing archive file to unpack.<br />If <code>remote_src=yes</code> and <code>[src]</code> contains <code>://</code>, the remote machine will download the file from the URL first. (version_added 2.0).</td>
</tr>
<tr>
<td><strong>dest</strong> path &#x2F; ï¼ˆrequiredï¼‰</td>
<td align="left">Remote absolute path where the archive should be unpacked.<br />The given path must exist. Base directory is not created by this module.</td>
</tr>
<tr>
<td><strong>creates</strong> path</td>
<td align="left">If the specified absolute path (file or directory) already exists, this step will <strong>not</strong> be run.<br />The specified absolute path (file or directory) must be below the base path given with <code>[dest]</code>.</td>
</tr>
<tr>
<td><strong>exclude</strong> list &#x2F; elements&#x3D;string</td>
<td align="left">List the directory and file entries that you would like to exclude from the unarchive action.<br />Mutually exclusive with <code>[include]</code>.<strong>Default:</strong> <code>[]</code></td>
</tr>
<tr>
<td><strong>include</strong> list &#x2F; elements&#x3D;string<em>added in ansible-core 2.11</em></td>
<td align="left">List of directory and file entries that you would like to extract from the archive. <br />If <code>[include]</code> is not empty, only files listed here will be extracted. <strong>Default:</strong> <code>[]</code></td>
</tr>
<tr>
<td><strong>owner</strong> string</td>
<td align="left">Name of the user that should own the filesystem object, as would be fed to <em>chown</em>.When left unspecified, it uses the current user unless you are root, in which case it can preserve the previous ownership.Specifying a numeric username will be assumed to be a user ID and not a username. Avoid numeric usernames to avoid this confusion.</td>
</tr>
<tr>
<td><strong>group</strong> string</td>
<td align="left">Name of the group that should own the filesystem object, as would be fed to <em>chown</em>.When left unspecified, it uses the current group of the current user unless you are root, in which case it can preserve the previous ownership.</td>
</tr>
<tr>
<td><strong>mode</strong> any</td>
<td align="left">The permissions of the destination file or directory. You must either add a leading zero so that Ansibleâ€™s YAML parser knows it is an octal number (like <code>0644</code> or <code>01777</code>) or quote it (like <code>&#39;644&#39;</code> or <code>&#39;1777&#39;</code>) so Ansible receives a string and can do its own conversion from string into number.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m unarchive -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é»˜è®¤copy=yes,å°†ç®¡ç†ç«¯çš„å‹ç¼©åŒ…å¤åˆ¶åˆ°è¿œç¨‹ä¸»æœºä¸Šåï¼Œè§£å‹åˆ°æŒ‡å®šç›®å½•ï¼Œå¹¶è®¾ç½®å±ä¸»å’Œå±ç»„ã€‚</span></span><br><span class="line">ansible websrvs -m unarchive -a <span class="string">&#x27;src=sys.tar.gz dest=/opt owner=haha group=bin&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®copy=no,å°†è¿œç¨‹ä¸»æœºä¸Šçš„æŸä¸ªå‹ç¼©åŒ…è§£å‹ç¼©åˆ°æŒ‡å®šè·¯å¾„ä¸‹ï¼Œ</span></span><br><span class="line">ansible websrvs -m unarchive -a <span class="string">&#x27;src=/opt/sys.tar.gz dest=/tmp copy=no mode=0777&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¹Ÿå¯ä»¥è®¾ç½®ç¬¬ä¸‰æ–¹åœ°å€</span></span><br><span class="line">ansible all -m unarchive -a <span class="string">&#x27;src=https://example.com/example.zip dest=/data copy=no&#x27;</span></span><br></pre></td></tr></table></figure>


</div><script src="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery) {
        var options1 = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1);
        }</script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-11-17</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« é‚“èƒ–èƒ–</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/Ansible/'>
                            Ansible
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>
                            å­¦ä¹ ç¬”è®°
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    <!-- <div class="post-footer-pre-next">
        <span>ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
        <span class="post-footer-pre-next-last-span-right">ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
    </div> -->

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
             

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery.min.js"></script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>