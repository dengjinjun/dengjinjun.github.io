<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="Ansibleæ ¸å¿ƒæ¨¡å—ï¼ˆä¸‹ï¼‰" />
    <meta name="hexo-theme-A4" content="v1.9.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Dengpangpang</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--è¿”å›é¡¶éƒ¨css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--ç›®å½•-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Dengpangpang</a> 
            <span class="description"></span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">ğŸŸé¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">ğŸ“æ–‡ç« </a></li>
            
        
            
                <li><a href="/tags/">ğŸ·ï¸æ ‡ç­¾</a></li>
            
        
            
                <li><a href="/categories/">ğŸ—‚ï¸åˆ†ç±»</a></li>
            
        
            
                <li><a href="/about/">ğŸ‘ï¸å…³äº</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            Ansibleæ ¸å¿ƒæ¨¡å—ï¼ˆä¸‹ï¼‰
        </div>
      
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#cron-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">cron æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#yum-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">yum æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#yum-repository%E6%A8%A1%E5%9D%97"><span class="post-toc-text">yum_repositoryæ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#service-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">service æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#user-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">user æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Group-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">Group æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Setup-%E6%A8%A1%E5%9D%97"><span class="post-toc-text">Setup æ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#mount%E6%A8%A1%E5%9D%97"><span class="post-toc-text">mountæ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#iptables%E6%A8%A1%E5%9D%97"><span class="post-toc-text">iptablesæ¨¡å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B3%A8%E6%84%8F"><span class="post-toc-text">æ³¨æ„</span></a></li></ol>
            
        
        <link rel="stylesheet" type="text/css" href="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/css/lightgallery.min.css" /><div class=".article-gallery"><h3 id="cron-æ¨¡å—"><a href="#cron-æ¨¡å—" class="headerlink" title="cron æ¨¡å—"></a>cron æ¨¡å—</h3><p>è®¡åˆ’ä»»åŠ¡</p>
<p>æ”¯æŒæ—¶é—´ï¼šminuteï¼Œhourï¼Œdayï¼Œmonthï¼Œweekday</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>backup</strong> boolean</td>
<td>If set, create a backup of the crontab before it is modified. Default choice is <code>false</code><br />The location of the backup is returned in the <code>backup_file</code> variable by this module.</td>
</tr>
<tr>
<td><strong>name</strong> string &#x2F; required</td>
<td>Description of a crontab entry or, if env is set, the name of environment variable.This parameter is always required as of ansible-core 2.12.</td>
</tr>
<tr>
<td><strong>job</strong> aliases: valuestring</td>
<td>The command to execute or, if env is set, the value of environment variable.The command should not contain line breaks.Required if <code>state=present</code>.</td>
</tr>
<tr>
<td><strong>disabled</strong> boolean</td>
<td>If the job should be disabled (commented out) in the crontab.Only has effect if <code>state=present</code>.<br />Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>state</strong> string</td>
<td>Whether to ensure the job or environment variable is present or absent.<strong>Choices:</strong><code>&quot;absent&quot;</code>ï¼Œ<code>&quot;present&quot;</code>  (default)</td>
</tr>
<tr>
<td><strong>env</strong> boolean</td>
<td>If set, manages a crontabâ€™s environment variable.New variables are added on top of crontab.<code>[name]</code> and <code>[value]</code> parameters are the name and the value of environment variable.Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>insertafter</strong> string</td>
<td>Used with <code>state=present</code> and <code>[env]</code>.If specified, the environment variable will be inserted after the declaration of specified environment variable.</td>
</tr>
<tr>
<td><strong>insertbefore</strong> string</td>
<td>Used with <code>state=present</code> and <code>[env]</code>.If specified, the environment variable will be inserted before the declaration of specified environment variable.</td>
</tr>
<tr>
<td><strong>minute</strong> string</td>
<td>Minute when the job should run (<code>0-59</code>, <code>*</code>, <code>*/2</code>, and so on).<strong>Default:</strong> <code>&quot;*&quot;</code></td>
</tr>
<tr>
<td><strong>hour</strong> string</td>
<td>Hour when the job should run (<code>0-23</code>, <code>*</code>, <code>*/2</code>, and so on).<strong>Default:</strong> <code>&quot;*&quot;</code></td>
</tr>
<tr>
<td><strong>day</strong> aliases: domstring</td>
<td>Day of the month the job should run (<code>1-31</code>, <code>*</code>, <code>*/2</code>, and so on).<strong>Default:</strong> <code>&quot;*&quot;</code></td>
</tr>
<tr>
<td><strong>month</strong> string</td>
<td>Month of the year the job should run (<code>1-12</code>, <code>*</code>, <code>*/2</code>, and so on).<strong>Default:</strong> <code>&quot;*&quot;</code></td>
</tr>
<tr>
<td><strong>weekday</strong> aliases: dowstring</td>
<td>Day of the week that the job should run (<code>0-6</code> for Sunday-Saturday, <code>*</code>, and so on).<strong>Default:</strong> <code>&quot;*&quot;</code></td>
</tr>
<tr>
<td><strong>special_time</strong> string</td>
<td>Special time specification nickname.<strong>Choices:</strong><code>&quot;annually&quot;``&quot;daily&quot;``&quot;hourly&quot;``&quot;monthly&quot;``&quot;reboot&quot;``&quot;weekly&quot;``&quot;yearly&quot;</code></td>
</tr>
<tr>
<td><strong>user</strong> string</td>
<td>The specific user whose crontab should be modified.When unset, this parameter defaults to the current user.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m corn -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºè®¡åˆ’ä»»åŠ¡ï¼Œå‘¨ä¸€åˆ°å‘¨äº”çš„ä¸¤ç‚¹åŠæ‰§è¡Œ/opt/mysql_backup.shè„šæœ¬ï¼Œè®¡åˆ’ä»»åŠ¡çš„åç§°æ˜¯backup mysql</span></span><br><span class="line">ansible dbsrvs -m cron -a <span class="string">&quot;hour=2 minute=30 weekday=1-5 name=&#x27;backup mysql&#x27; job=/opt/mysql_backup.sh&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å†åˆ›å»ºä¸€ä¸ªæ—¶é—´åŒæ­¥çš„è®¡åˆ’ä»»åŠ¡</span></span><br><span class="line">ansible dbsrvs -m cron -a <span class="string">&#x27;minute=*/5 name=Synctime job=&quot;/usr/sbin/ntpdate ntp.aliyun.com &amp;&gt;/dev/null&quot; &#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#åˆ é™¤ä»»åŠ¡</span></span><br><span class="line">ansible dbsrvs -m cron -a <span class="string">&#x27;name=&quot;backup mysql&quot; state=absent&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ç¦ç”¨è®¡åˆ’ä»»åŠ¡,å¿…é¡»åŠ ä¸Šjobå‚æ•°</span></span><br><span class="line">ansible dbsrvs -m cron -a <span class="string">&#x27;minute=*/5 job=&quot;/usr/sbin/ntpdate ntp.aliyun.com &amp;&gt;/dev/null&quot; name=Synctime disabled=yes&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å¯ç”¨è®¡åˆ’ä»»åŠ¡</span></span><br><span class="line">ansible dbsrvs -m cron -a <span class="string">&#x27;minute=*/5 job=&quot;/usr/sbin/ntpdate ntp.aliyun.com &amp;&gt;/dev/null&quot; name=Synctime disabled=no&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="yum-æ¨¡å—"><a href="#yum-æ¨¡å—" class="headerlink" title="yum æ¨¡å—"></a>yum æ¨¡å—</h3><p>ç®¡ç†è½¯ä»¶åŒ…ï¼Œåªæ”¯æŒRHELï¼ŒCentOSï¼Œfedoraï¼Œä¸æ”¯æŒUbuntuå…¶å®ƒç‰ˆæœ¬</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>conf_file</strong> string</td>
<td>The remote yum configuration file to use for the transaction.</td>
</tr>
<tr>
<td><strong>disablerepo</strong> list &#x2F; elements&#x3D;string</td>
<td><em>Repoid</em> of repositories to disable for the install&#x2F;update operation. These repos will not persist beyond the transaction. When specifying multiple repos, separate them with a <code>&quot;,&quot;</code>.As of Ansible 2.7, this can alternatively be a list instead of <code>&quot;,&quot;</code> separated string<strong>Default:</strong> <code>[]</code></td>
</tr>
<tr>
<td><strong>enablerepo</strong> list &#x2F; elements&#x3D;string</td>
<td><em>Repoid</em> of repositories to enable for the install&#x2F;update operation. These repos will not persist beyond the transaction. When specifying multiple repos, separate them with a <code>&quot;,&quot;</code>.As of Ansible 2.7, this can alternatively be a list instead of <code>&quot;,&quot;</code> separated string. <strong>Default:</strong> <code>[]</code></td>
</tr>
<tr>
<td><strong>exclude</strong> list &#x2F; elements&#x3D;string</td>
<td>Package name(s) to exclude when state&#x3D;present, or latest<strong>Default:</strong> <code>[]</code></td>
</tr>
<tr>
<td><strong>name</strong> aliases: pkglist &#x2F; elements&#x3D;string</td>
<td>A package name or package specifier with version, like <code>name-1.0</code>.<br />Comparison operators for package version are valid here <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>. Example - <code>name&gt;=1.0</code>If a previous version is specified, the task also needs to turn <code>[allow_downgrade]</code> on. <br />See the <code>[allow_downgrade]</code> documentation for caveats with downgrading packages.When using <code>state=latest</code>, this can be <code>&#39;*&#39;</code> which means run <code>yum -y update</code>.You can also pass a url or a local path to an rpm file (using <code>state=present</code>). To operate on several packages this can accept a comma separated string of packages or (as of 2.0) a list of packages.<strong>Default:</strong> <code>[]</code></td>
</tr>
<tr>
<td><strong>list</strong> string</td>
<td>Package name to run the equivalent of <code>yum list --show-duplicates &lt;package&gt;</code> against. In addition to listing packages, use can also list the following: <code>installed</code>, <code>updates</code>, <code>available</code> and <code>repos</code>.This parameter is mutually exclusive with <code>[name]</code>.</td>
</tr>
<tr>
<td><strong>state</strong> string</td>
<td>Whether to install (<code>present</code> or <code>installed</code>, <code>latest</code>), or remove (<code>absent</code> or <code>removed</code>) a package.<br /><code>present</code> and <code>installed</code> will simply ensure that a desired package is installed.<br /><code>latest</code> will update the specified package if itâ€™s not of the latest available version.<br /><code>absent</code> and <code>removed</code> will remove the specified package.<br />Default is <code>None</code>. <strong>Choices:</strong><code>&quot;absent&quot;``&quot;installed&quot;``&quot;latest&quot;``&quot;present&quot;``&quot;removed&quot;</code></td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m yum -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…è½¯ä»¶åŒ…ï¼Œå®‰è£…å¤šä¸ªç”¨é€—å·éš”å¼€ï¼Œpresentå¯ä»¥çœç•¥</span></span><br><span class="line">ansible websrvs -m yum -a <span class="string">&#x27;name=iotop,telnet state=present&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤</span></span><br><span class="line">ansible websrvs -m yum -a <span class="string">&#x27;name=iotop state=absent&#x27;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ›´æ–°</span></span><br><span class="line">ansible websrvs -m yum -a <span class="string">&#x27;name=iotop state=latest&#x27;</span> </span><br></pre></td></tr></table></figure>

<h3 id="yum-repositoryæ¨¡å—"><a href="#yum-repositoryæ¨¡å—" class="headerlink" title="yum_repositoryæ¨¡å—"></a>yum_repositoryæ¨¡å—</h3><p>ç®¡ç†yumæº</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>baseurl</strong> list &#x2F; elements&#x3D;string</td>
<td>URL to the directory where the yum repositoryâ€™s â€˜repodataâ€™ directory lives.It can also be a list of multiple URLs.This, the <code>[metalink]</code> or <code>[mirrorlist]</code> parameters are required if <code>[state]</code> is set to <code>present</code>.</td>
</tr>
<tr>
<td><strong>description</strong> string</td>
<td>A human readable string describing the repository. This option corresponds to the â€œnameâ€ property in the repo file.This parameter is only required if <code>[state]</code> is set to <code>present</code>.</td>
</tr>
<tr>
<td><strong>enabled</strong> boolean</td>
<td>This tells yum whether or not use this repository.Yum default value is <code>true</code>.<strong>Choices:</strong><code>false</code>ï¼Œ<code>true</code></td>
</tr>
<tr>
<td><strong>file</strong> string</td>
<td>File name without the <code>.repo</code> extension to save the repo in. Defaults to the value of <code>[name]</code>.</td>
</tr>
<tr>
<td><strong>gpgcakey</strong> string</td>
<td>A URL pointing to the ASCII-armored CA key file for the repository.</td>
</tr>
<tr>
<td><strong>gpgcheck</strong> boolean</td>
<td>Tells yum whether or not it should perform a GPG signature check on packages.No default setting. If the value is not set, the system setting from <code>/etc/yum.conf</code> or system default of <code>false</code> will be used.<strong>Choices:</strong><code>false</code>ï¼Œ<code>true</code></td>
</tr>
<tr>
<td><strong>gpgkey</strong> list &#x2F; elements&#x3D;string</td>
<td>A URL pointing to the ASCII-armored GPG key file for the repository.It can also be a list of multiple URLs.</td>
</tr>
<tr>
<td><strong>include</strong> string</td>
<td>Include external configuration file. Both, local path and URL is supported. Configuration file will be inserted at the position of the <code>include=</code> line. Included files may contain further include lines. Yum will abort with an error if an inclusion loop is detected.</td>
</tr>
<tr>
<td><strong>keepcache</strong> string</td>
<td>Either <code>1</code> or <code>0</code>. Determines whether or not yum keeps the cache of headers and packages after successful installation.This parameter is deprecated and will be removed in version 2.20.<strong>Choices:</strong><code>&quot;0&quot;</code>ï¼Œ<code>&quot;1&quot;</code></td>
</tr>
<tr>
<td><strong>metalink</strong> string</td>
<td>Specifies a URL to a metalink file for the repomd.xml, a list of mirrors for the entire repository are generated by converting the mirrors for the repomd.xml file to a <code>[baseurl]</code>.This, the <code>[baseurl]</code> or <code>[mirrorlist]</code> parameters are required if <code>[state]</code> is set to <code>present</code>.</td>
</tr>
<tr>
<td><strong>mirrorlist</strong> string</td>
<td>Specifies a URL to a file containing a list of baseurls.This, the <code>[baseurl]</code> or <code>[metalink]</code> parameters are required if <code>**[state]</code> is set to <code>present</code>.</td>
</tr>
<tr>
<td><strong>name</strong> string &#x2F; required</td>
<td>Unique repository ID. This option builds the section name of the repository in the repo file.This parameter is only required if <code>[state]</code> is set to <code>present</code> or <code>absent</code>.</td>
</tr>
<tr>
<td><strong>priority</strong> string</td>
<td>Enforce ordered protection of repositories. The value is an integer from 1 to 99.This option only works if the YUM Priorities plugin is installed.</td>
</tr>
<tr>
<td><strong>state</strong> string</td>
<td>State of the repo file.<strong>Choices:</strong><code>&quot;absent&quot;</code>ï¼Œ<code>&quot;present&quot;</code> â† (default)</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m yum_repository -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m yum_repository -a <span class="string">&#x27;file=nginx name=nginx description=&quot;nginx repo&quot;  baseurl=&quot;http://nginx.org/packages/centos/$releasever/$basearch/&quot; state=present enabled=yes gpgcheck=no&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="service-æ¨¡å—"><a href="#service-æ¨¡å—" class="headerlink" title="service æ¨¡å—"></a>service æ¨¡å—</h3><p>ç®¡ç†æœåŠ¡</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>name</strong> string &#x2F; ï¼ˆrequiredï¼‰</td>
<td>Name of the service.</td>
</tr>
<tr>
<td><strong>enabled</strong> boolean</td>
<td>Whether the service should start on boot.**At least one of state and enabled are required.**Choices:<code>false</code>ï¼Œ<code>true</code></td>
</tr>
<tr>
<td><strong>state</strong> string</td>
<td><code>started</code>&#x2F;<code>stopped</code> are idempotent actions that will not run commands unless necessary.<br /><code>restarted</code> will always bounce the service.<code>reloaded</code> will always reload.<strong>At least one of state and enabled are required.</strong><br />Note that reloaded will start the service if it is not already started, even if your chosen init system wouldnâ€™t normally.<br /><strong>Choices:</strong><code>&quot;reloaded&quot;</code>ï¼Œ<code>&quot;restarted&quot;</code>ï¼Œ<code>&quot;started&quot;</code>ï¼Œ<code>&quot;stopped&quot;</code></td>
</tr>
<tr>
<td><strong>sleep</strong> integer</td>
<td>If the service is being <code>restarted</code> then sleep this many seconds between the stop and start command.This helps to work around badly-behaving init scripts that exit immediately after signaling a process to stop.Not all service managers support sleep, i.e when using systemd this setting will be ignored.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m service -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨æœåŠ¡ï¼Œè®¾ç½®è‡ªå¯</span></span><br><span class="line">ansible all -m service -a <span class="string">&#x27;name=httpd state=started enabled=yes&#x27;</span></span><br><span class="line"><span class="comment"># åœæ­¢æœåŠ¡</span></span><br><span class="line">ansible all -m service -a <span class="string">&#x27;name=httpd state=stopped&#x27;</span></span><br><span class="line"><span class="comment"># é‡è½½</span></span><br><span class="line">ansible all -m service -a <span class="string">&#x27;name=httpd state=reloaded&#x27;</span></span><br><span class="line"><span class="comment"># é‡å¯</span></span><br><span class="line">ansible all -m service -a <span class="string">&#x27;name=httpd state=restarted&#x27;</span></span><br></pre></td></tr></table></figure>





<h3 id="user-æ¨¡å—"><a href="#user-æ¨¡å—" class="headerlink" title="user æ¨¡å—"></a>user æ¨¡å—</h3><p>ç®¡ç†ç”¨æˆ·</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>name</strong> aliases: userstring &#x2F;(required)</td>
<td>Name of the user to create, remove or modify.</td>
</tr>
<tr>
<td><strong>comment</strong> string</td>
<td>Optionally sets the description (aka <em>GECOS</em>) of user account.On macOS, this defaults to the <code>[name]</code> option.</td>
</tr>
<tr>
<td><strong>uid</strong> integer</td>
<td>Optionally sets the <em>UID</em> of the user.</td>
</tr>
<tr>
<td><strong>group</strong> string</td>
<td>Optionally sets the userâ€™s primary group (takes a group name).On macOS, this defaults to <code>&#39;staff&#39;</code></td>
</tr>
<tr>
<td><strong>create_home</strong> aliases: createhome boolean</td>
<td>Unless set to <code>false</code>, a home directory will be made for the user when the account is created or if the home directory does not exist. Default choice is <code>true</code></td>
</tr>
<tr>
<td><strong>home</strong> path</td>
<td>Optionally set the userâ€™s home directory.</td>
</tr>
<tr>
<td><strong>force</strong> boolean</td>
<td>This only affects <code>state=absent</code>, it forces removal of the user and associated directories on supported platforms.The behavior is the same as <code>userdel --force</code>.When used with <code>generate_ssh_key=yes</code> this forces an existing key to be overwritten.Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>generate_ssh_key</strong> boolean</td>
<td>Whether to generate a SSH key for the user in question.This will <strong>not</strong> overwrite an existing SSH key unless used with <code>force=yes</code>.Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>non_unique</strong> boolean</td>
<td>Optionally when used with the -u option, this option allows to change the user ID to a non-unique value. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>system</strong> boolean</td>
<td>When creating an account <code>state=present</code>, setting this to <code>true</code> makes the user a system account.This setting cannot be changed on existing users. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>password</strong> string</td>
<td>If provided, set the userâ€™s password to the provided encrypted hash (Linux) or plain text password (macOS).<strong>Linux&#x2F;Unix&#x2F;POSIX:</strong> Enter the hashed password as the value.</td>
</tr>
<tr>
<td><strong>remove</strong> boolean</td>
<td>This only affects <code>state=absent</code>, it attempts to remove directories associated with the user.The behavior is the same as <code>userdel --remove</code>, check the man page for details and support.Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>shell</strong> string</td>
<td>Optionally set the userâ€™s shell.</td>
</tr>
<tr>
<td><strong>state</strong> string</td>
<td>Whether the account should exist or not, taking action if the state is different from what is stated.See this <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/reference_appendices/faq.html#running-on-macos-as-a-target">FAQ entry</a> for additional requirements when removing users on macOS systems.<br /><strong>Choices:</strong><code>&quot;absent&quot;</code>ï¼Œ<code>&quot;present&quot;</code> â† (default)</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m user -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç”¨æˆ·,æŒ‡å®šç”¨æˆ·åã€æè¿°ã€uidã€å®¶ç›®å½•ã€æ‰€å±ç»„</span></span><br><span class="line">ansible all -m user -a <span class="string">&#x27;name=user1 comment=&quot;test user&quot; uid=2048 home=/app/user1 group=root&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·å æè¿° uid æ‰€å±ç»„ ä»å±ç»„ shellç±»å‹ æ˜¯å¦ç³»ç»Ÿè´¦æˆ· æ˜¯å¦åˆ›å»ºå®¶ç›®å½• å®¶ç›®å½•è·¯å¾„ uidæ˜¯å¦å”¯ä¸€</span></span><br><span class="line">ansible all -m user -a <span class="string">&#x27;name=nginx comment=nginx uid=88 group=nginx groups=&quot;root,daemon&quot; shell=/sbin/nologin system=yes create_home=no home=/data/nginx non_unique=yes&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ç”¨æˆ·ï¼Œremove=yesè¡¨ç¤ºåˆ é™¤ç”¨æˆ·åŠå®¶ç›®å½•ç­‰æ•°æ®ï¼Œé»˜è®¤remove=no</span></span><br><span class="line">ansible all -m user -a <span class="string">&#x27;name=nginx state=absent remove=yes&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="Group-æ¨¡å—"><a href="#Group-æ¨¡å—" class="headerlink" title="Group æ¨¡å—"></a>Group æ¨¡å—</h3><p>ç®¡ç†ç»„</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>name</strong> string &#x2F; required</td>
<td>Name of the group to manage.</td>
</tr>
<tr>
<td><strong>gid</strong> integer</td>
<td>Optional <em>GID</em> to set for the group.</td>
</tr>
<tr>
<td><strong>force</strong> boolean<em>added in ansible-core 2.15</em></td>
<td>Whether to delete a group even if it is the primary group of a user.Only applicable on platforms which implement a â€“force flag on the group deletion command. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>non_unique</strong> boolean <em>added in Ansible 2.8</em></td>
<td>This option allows to change the group ID to a non-unique value. Requires <code>[gid]</code>.Not supported on macOS or BusyBox distributions. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>state</strong> string</td>
<td>Whether the group should be present or not on the remote host.<br /><strong>Choices:</strong><code>&quot;absent&quot;</code>ï¼Œ<code>&quot;present&quot;</code> â† (default)</td>
</tr>
<tr>
<td><strong>system</strong> boolean</td>
<td>If <code>yes</code>, indicates that the group created is a system group. Default choice is <code>false</code></td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m group -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç»„</span></span><br><span class="line">ansible websrvs -m group -a <span class="string">&#x27;name=nginx gid=88 system=yes&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ç»„</span></span><br><span class="line">ansible websrvs -m group -a <span class="string">&#x27;name=nginx state=absent&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="Setup-æ¨¡å—"><a href="#Setup-æ¨¡å—" class="headerlink" title="Setup æ¨¡å—"></a>Setup æ¨¡å—</h3><p> setup æ¨¡å—æ¥æ”¶é›†ä¸»æœºçš„ç³»ç»Ÿä¿¡æ¯ï¼Œè¿™äº› facts ä¿¡æ¯å¯ä»¥ç›´æ¥ä»¥å˜é‡çš„å½¢å¼ä½¿ç”¨ï¼Œä½†æ˜¯å¦‚æœä¸»æœºè¾ƒå¤šï¼Œä¼šå½±å“æ‰§è¡Œé€Ÿåº¦ï¼Œå¯ä»¥ä½¿ç”¨gather_facts: no æ¥ç¦æ­¢ Ansible æ”¶é›† facts ä¿¡æ¯</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>filter</strong> list &#x2F; elements&#x3D;string</td>
<td>If supplied, only return facts that match one of the shell-style (fnmatch) pattern. An empty list basically means â€˜no filterâ€™. As of Ansible 2.11, the type has changed from string to list and the default has became an empty list. A simple string is still accepted and works as a single pattern. The behaviour prior to Ansible 2.11 remains.<strong>Default:</strong> <code>[]</code></td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m setup -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ansible all -m setup		<span class="comment">#æ”¶é›†æœåŠ¡å™¨è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_nodename&quot;</span>		<span class="comment">#ä¸»æœºå…¨å</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_hostname&quot;</span>		<span class="comment">#ä¸»æœºåï¼ˆéƒ¨åˆ†åç§°ï¼‰</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_os_family&quot;</span>		<span class="comment">#æ“ä½œç³»ç»Ÿå®¶æ—</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_domain&quot;</span>			<span class="comment">#åŸŸå</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_memtotal_mb&quot;</span>		<span class="comment">#å†…å­˜æ€»å¤§å°</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_memory_mb&quot;</span>		<span class="comment">#å†…å­˜ï¼ŒåŒ…å«äº¤æ¢åˆ†åŒºç­‰</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_memfree_mb&quot;</span>		<span class="comment">#å‰©ä½™å†…å­˜</span></span><br><span class="line"></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_distribution_major_version&quot;</span>	<span class="comment">#æ“ä½œç³»ç»Ÿç‰ˆæœ¬å·</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_distribution_version&quot;</span>		<span class="comment">#å°ç‰ˆæœ¬å·</span></span><br><span class="line">ansible websrvs -m setup -a <span class="string">&quot;filter=ansible_distribution&quot;</span>		<span class="comment">#æ“ä½œç³»ç»Ÿç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_processor_vcpus&quot;</span>		<span class="comment">#cpuä¸ªæ•°</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_all_ipv4_addresses&quot;</span>		<span class="comment">#å¤šå—ç½‘å¡çš„æ‰€æœ‰ipåœ°å€</span></span><br><span class="line">ansible all -m setup -a <span class="string">&quot;filter=ansible_default_ipv4&quot;</span>			<span class="comment">#é»˜è®¤ipåœ°å€		</span></span><br></pre></td></tr></table></figure>



<h3 id="mountæ¨¡å—"><a href="#mountæ¨¡å—" class="headerlink" title="mountæ¨¡å—"></a>mountæ¨¡å—</h3><p>ç£ç›˜æŒ‚è½½ç›¸å…³ </p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>å‚æ•°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>fstype</td>
<td>æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹ï¼Œå¦‚nfsï¼Œxfsï¼Œext4ç­‰</td>
</tr>
<tr>
<td>src</td>
<td>æŒ‚è½½æºï¼Œå¦‚src&#x3D;172.16.1.31:&#x2F;data&#x2F;zh</td>
</tr>
<tr>
<td>path</td>
<td>åœ¨ç›®æ ‡ä¸»æœºçš„æŒ‚è½½è·¯å¾„ï¼Œå¦‚path&#x3D;&#x2F;mnt&#x2F;new-lidao-mount</td>
</tr>
<tr>
<td>state</td>
<td>çŠ¶æ€<br />present ï¼šä»…ä¿®æ”¹é…ç½®ï¼Œå¼€æœºæŒ‚è½½ï¼Œä»…å°†æŒ‚è½½é…ç½®å†™å…¥&#x2F;etc&#x2F;fstab<br/>mountedï¼šæŒ‚è½½+ä¿®æ”¹é…ç½®ï¼ŒæŒ‚è½½è®¾å¤‡ï¼Œå¹¶å°†é…ç½®å†™å…¥&#x2F;etc&#x2F;fstab<br/>unmountedï¼šå¸è½½è®¾å¤‡ï¼Œä¸ä¼šæ¸…é™¤&#x2F;etc&#x2F;fstabå†™å…¥çš„é…ç½®<br/>absentï¼š å¸è½½è®¾å¤‡ï¼Œä¼šæ¸…ç†&#x2F;etc&#x2F;fstabå†™å…¥çš„é…ç½®<br/>remountedï¼šé‡æ–°æŒ‚è½½</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m mount -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‚è½½nfsï¼Œå¦‚æœè¦æŒ‚è½½ç‚¹ç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™ä¼šè‡ªåŠ¨åˆ›å»ºç›®å½•</span></span><br><span class="line">ansible all -m mount -a <span class="string">&#x27;fstype=nfs src=172.16.1.31:/data/zh  path=/mnt/   state=mounted&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="iptablesæ¨¡å—"><a href="#iptablesæ¨¡å—" class="headerlink" title="iptablesæ¨¡å—"></a>iptablesæ¨¡å—</h3><p>è®¾ç½®é˜²ç«å¢™</p>
<blockquote>
<p><strong>å‚æ•°</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Comments</th>
</tr>
</thead>
<tbody><tr>
<td><strong>table</strong> string</td>
<td>This option specifies the packet matching table which the command should operate on.<br /><strong>Choices:</strong><code>&quot;filter&quot;</code> â† (default)ï¼Œ<code>&quot;nat&quot;</code>ï¼Œ<code>&quot;mangle&quot;</code>ï¼Œ<code>&quot;raw&quot;</code>ï¼Œ<code>&quot;security&quot;</code></td>
</tr>
<tr>
<td><strong>chain</strong> string</td>
<td>Specify the iptables chain to modify.This could be a user-defined chain or one of the standard iptables chains,<br /> like <code>INPUT</code>, <code>FORWARD</code>, <code>OUTPUT</code>, <code>PREROUTING</code>, <code>POSTROUTING</code>, <code>SECMARK</code> or <code>CONNSECMARK</code>.</td>
</tr>
<tr>
<td><strong>action</strong> string</td>
<td>Whether the rule should be appended at the bottom or inserted at the top.<br />If the rule already exists the chain will not be modified. <strong>Choices:</strong><code>&quot;append&quot;</code> â† (default)ï¼Œ<code>&quot;insert&quot;</code></td>
</tr>
<tr>
<td><strong>comment</strong> string</td>
<td>This specifies a comment that will be added to the rule.</td>
</tr>
<tr>
<td><strong>protocol</strong> string</td>
<td>The protocol of the rule or of the packet to check.The specified protocol can be one of <code>tcp</code>, <code>udp</code>, <code>udplite</code>, <code>icmp</code>, <code>ipv6-icmp</code> or <code>icmpv6</code>, <code>esp</code>, <code>ah</code>, <code>sctp</code> or the special keyword <code>all</code>, or it can be a numeric value, representing one of these protocols or a different one.<br />A protocol name from <code>/etc/protocols</code> is also allowed.<br />A <code>!</code> argument before the protocol inverts the test.The number zero is equivalent to all.<br /><code>all</code> will match with all protocols and is taken as default when this option is omitted.</td>
</tr>
<tr>
<td><strong>source</strong> string</td>
<td>Source specification.<br />Address can be a network name, a hostname, a network IP address (with &#x2F;mask), or a plain IP address.<br />Hostnames will be resolved once only, before the rule is submitted to the kernel. Please note that specifying any name to be resolved with a remote query such as DNS is a really bad idea.<br />The mask can be either a network mask or a plain number, specifying the number of 1â€™s at the left side of the network mask. Thus, a mask of 24 is equivalent to 255.255.255.0.<br /> A <code>!</code> argument before the address specification inverts the sense of the address.</td>
</tr>
<tr>
<td><strong>src_range</strong> string<em>added in Ansible 2.8</em></td>
<td>Specifies the source IP range to match in the iprange module.</td>
</tr>
<tr>
<td><strong>destination</strong> string</td>
<td>Destination specification.<br />Address can be  a network name, a hostname, a network IP address (with &#x2F;mask), or a plain IP address.<br />Hostnames will be resolved once only, before the rule is submitted to the kernel. <br />Please note that specifying any name to be resolved with a remote query such as DNS is a really bad idea.<br />The mask can be either a network mask or a plain number, specifying the number of 1â€™s at the left side of the network mask. Thus, a mask of 24 is equivalent to 255.255.255.0. <br />A <code>!</code> argument before the address specification inverts the sense of the address.</td>
</tr>
<tr>
<td><strong>dst_range</strong> string<em>added in Ansible 2.8</em></td>
<td>Specifies the destination IP range to match in the iprange module.</td>
</tr>
<tr>
<td><strong>source_port</strong> string</td>
<td>Source port or port range specification.This can either be a service name or a port number.<br />An inclusive range can also be specified, using the format <code>first:last</code>.<br />If the first port is omitted, <code>0</code> is assumed; if the last is omitted, <code>65535</code> is assumed.<br />If the first port is greater than the second one they will be swapped.</td>
</tr>
<tr>
<td><strong>destination_port</strong> string</td>
<td>Destination port or port range specification. This can either be a service name or a port number. <br />An inclusive range can also be specified, using the format first:last. <br />If the first port is omitted, â€˜0â€™ is assumed; if the last is omitted, â€˜65535â€™ is assumed. <br />If the first port is greater than the second one they will be swapped. <br />This is only valid if the rule also specifies one of the following protocols: tcp, udp, dccp or sctp.</td>
</tr>
<tr>
<td><strong>destination_ports</strong> list &#x2F; elements&#x3D;string</td>
<td>This specifies multiple destination port numbers or port ranges to match in the multiport module.<br />It can only be used in conjunction with the protocols tcp, udp, udplite, dccp and sctp.<strong>Default:</strong> <code>[]</code></td>
</tr>
<tr>
<td><strong>jump</strong> string</td>
<td>This specifies the target of the rule; i.e., what to do if the packet matches it.</td>
</tr>
<tr>
<td><strong>state</strong> string</td>
<td>Whether the rule should be absent or present.<strong>Choices:</strong><code>&quot;absent&quot;</code>ï¼Œ<code>&quot;present&quot;</code> â† (default)</td>
</tr>
<tr>
<td><strong>flush</strong> boolean</td>
<td>Flushes the specified table and chain of all rules.If no chain is specified then the entire table is purged.<br />Ignores all other parameters. Default choice is <code>false</code></td>
</tr>
<tr>
<td><strong>out_interface</strong> string</td>
<td>Name of an interface via which a packet is going to be sent (for packets entering the <code>FORWARD</code>, <code>OUTPUT</code> and <code>POSTROUTING</code> chains).When the <code>!</code> argument is used before the interface name, the sense is inverted.If the interface name ends in a <code>+</code>, then any interface which begins with this name will match.If this option is omitted, any interface name will match.</td>
</tr>
<tr>
<td><strong>policy</strong> string</td>
<td>Set the policy for the chain to the given target.Only built-in chains can have policies.This parameter requires the <code>[chain]</code> parameter.If you specify this parameter, all other parameters will be ignored.<br />This parameter is used to set default policy for the given <code>[chain]</code>. Donâ€™t confuse with <code>[jump]</code> parameter.<br /><strong>Choices:</strong><code>&quot;ACCEPT&quot;</code>ï¼Œ<code>&quot;DROP&quot;</code>ï¼Œ<code>&quot;QUEUE&quot;</code>ï¼Œ<code>&quot;RETURN&quot;</code></td>
</tr>
<tr>
<td><strong>to_destination</strong> string</td>
<td>This specifies a destination address to use with <code>DNAT</code>.Without this, the destination address is never altered.</td>
</tr>
<tr>
<td><strong>to_source</strong> string</td>
<td>This specifies a source address to use with <code>SNAT</code>.Without this, the source address is never altered.</td>
</tr>
<tr>
<td><strong>to_ports</strong> string</td>
<td>This specifies a destination port or range of ports to use, without this, the destination port is never altered.<br />This is only valid if the rule also specifies one of the protocol <code>tcp</code>, <code>udp</code>, <code>dccp</code> or <code>sctp</code>.</td>
</tr>
</tbody></table>
<blockquote>
<p><strong>ad-hoc</strong></p>
</blockquote>
<p>æ ¼å¼ï¼š<code>ansible ä¸»æœºå -m iptables -a &quot;cmd&quot;</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–°å¢ä¸€æ¡é˜²ç«å¢™ç­–ç•¥</span></span><br><span class="line">ansible web -m iptables -a <span class="string">&#x27;table=filter action=insert chain=INPUT source=10.0.0.0/24 protocol=tcp  destination_port=80 jump=DROP state=present&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><p>é™¤äº†ä»¥ä¸Šæ¨¡å—ä»¥å¤–ï¼Œè¿˜æœ‰å…¶ä»–çš„å¸¸ç”¨æ¨¡å—ä¸å†èµ˜è¿°ã€‚æ›´å¤šæ¨¡å—ä»‹ç»è¯¦è§å®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/index.html#plugins-in-ansible-builtin"> æ¨¡å—å‚è€ƒ </a></p>
<p>è¿™äº›æ¨¡å—åŠŸèƒ½æœ‰äº›ä½¿ç”¨shellæ¨¡å—ç›´æ¥è¿è¡Œå‘½ä»¤ä¹Ÿå¯ä»¥å®ç°ï¼Œä½†æ˜¯å¹¶ä¸æ¨èï¼Œå› ä¸ºä½¿ç”¨ansibleæ¨¡å—å…·æœ‰</p>
<ol>
<li>Idempotencyï¼ˆå¹‚ç­‰æ€§ï¼‰ï¼šå³æ— è®ºè¿è¡Œå¤šå°‘æ¬¡ï¼Œéƒ½ä¼šç¡®ä¿æ‰€éœ€çš„çŠ¶æ€è¢«åº”ç”¨ã€‚ç›¸åï¼Œä½¿ç”¨shellæ¨¡å—æ‰§è¡Œå‘½ä»¤æ—¶ï¼Œéœ€è¦æ‰‹åŠ¨ç¼–å†™é€»è¾‘æ¥ç¡®ä¿è¿™ç§çŠ¶æ€çš„è¾¾æˆã€‚</li>
<li>å¯è¯»æ€§å’Œç»´æŠ¤æ€§ï¼šä½¿ç”¨ä¸“é—¨çš„æ¨¡å—å¯ä»¥ä½¿Playbookæ›´æ˜“äºé˜…è¯»å’Œç»´æŠ¤ã€‚mountæ¨¡å—å’Œiptablesæ¨¡å—æä¾›äº†æ¸…æ™°çš„æŠ½è±¡ï¼Œå¯ä»¥è®©æ“ä½œæ›´æ˜“äºç†è§£ï¼Œå¹¶ä¸”å‡å°‘äº†å¯¹ç‰¹å®šå‘½ä»¤è¯­æ³•çš„ä¾èµ–ã€‚</li>
<li>å®‰å…¨æ€§ï¼šä½¿ç”¨ä¸“é—¨çš„æ¨¡å—å¯ä»¥æé«˜å®‰å…¨æ€§ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸ä¼šæä¾›å†…ç½®çš„é”™è¯¯æ£€æŸ¥å’Œå®‰å…¨æ€§æªæ–½ï¼Œä»¥ç¡®ä¿æ­£ç¡®çš„å‚æ•°å’Œé…ç½®ã€‚</li>
</ol>
<p>æ€»çš„æ¥è¯´ï¼Œé¦–é€‰åº”è¯¥æ˜¯ä½¿ç”¨Ansibleæä¾›çš„ä¸“é—¨æ¨¡å—ï¼Œå°¤å…¶æ˜¯å¯¹äºå¸¸è§çš„ç³»ç»Ÿç®¡ç†ä»»åŠ¡ï¼Œå› ä¸ºè¿™æ ·æ›´æ˜“äºç¼–å†™ã€ç†è§£å’Œç»´æŠ¤ã€‚</p>
</div><script src="https://jsd.cdn.zzko.cn/npm/hexo-theme-a4@latest/source/js/lightgallery.min.js"></script><script>if("undefined"!=typeof lightGallery) {
        var options1 = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1);
        }</script>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-11-18</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« é‚“èƒ–èƒ–</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/Ansible/'>
                            Ansible
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>
                            å­¦ä¹ ç¬”è®°
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    <!-- <div class="post-footer-pre-next">
        <span>ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
        <span class="post-footer-pre-next-last-span-right">ä¸Šä¸€ç¯‡ï¼š<a href=""></a></span>
    </div> -->

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
             

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--ç›®å½•-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--å›åˆ°é¡¶éƒ¨æŒ‰é’®-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery.min.js"></script>



                </div>
            
            
                <!-- å›åˆ°é¡¶éƒ¨çš„æŒ‰é’®-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- è¿”å›çš„æŒ‰é’®-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>